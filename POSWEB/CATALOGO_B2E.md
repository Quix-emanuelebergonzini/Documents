FGNEG-0100107-1:~ posweb$ cd /rnd/pos/mmfg/posweb/
FGNEG-0100107-1:posweb posweb$ ./bin/run_python.sh bin/catalog_b2e_generator.py -f
DEBUG:mmfg.app.tracer:DATADOG TRACER LIB NOT AVAILABLE
DEBUG:mmfg.connection.mysql:can't find module _mysql: no mysql connection available
DEBUG:mmfg.locator:Overriding previous Service configuration for name StandardTranslator (LazyProvider(package="mmfg.translations.service", attributes={}), True)
DEBUG:mmfg.locator:Overriding previous Service configuration for name StandardTranslator (LazyProvider(package="mmfg.translations.service", attributes={}), True)
DEBUG:mmfg.locator:Overriding previous Source configuration for name TaxfreeCountry (LazyProvider(package="backend.common.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), True)
DEBUG:mmfg.locator:Overriding previous Source configuration for name Price (LazyProvider(package="backend.common.source", attributes={'connection_name': 'catalogo', 'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), True)
DEBUG:mmfg.locator:Overriding previous Source configuration for name FidelitySourceMain (LazyProvider(package="backend.fidelity.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), True)
DEBUG:mmfg.locator:Overriding previous Entity configuration for name PromotionType (LazyProvider(package="common.entity", attributes={}), True)
Traceback (most recent call last):
  File "site/bin/config/storage_api.py", line 32, in <module>
    from core.cloud import storage
  File "/rnd/pos/mmfg/posweb/site/bin/lib/core/cloud/storage.py", line 10, in <module>
    import requests
ModuleNotFoundError: No module named 'requests'

ERROR:mmfg:IMPOSSIBILE UTILIZZARE GOOGLE CLOUD STORAGE: No module named 'requests'
DEBUG:mmfg.locator:Service StoreConfig was requested with domain None and context {'COD_NEGOZIO': '0100107'}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10ddb7580>
DEBUG:mmfg.locator:Using provider LazyProvider(package="backend.common.service", attributes={})
DEBUG:mmfg.locator:Using service <backend.common.service.StoreConfig object at 0x10ddb7610>
WARNING:mmfg.domain:Cleaning up cache: forgetting about all entities
DEBUG:mmfg.domain:getsome of StoreConfig entities matching expression (e.cod_negozio == '0100107') & (e.key == 'B2E_ENABLED'); can't find in cache, using source
DEBUG:mmfg.locator:instantiating source POSConfig (asked entity StoreConfig, provider LazyProvider(package="backend.common.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), conditions True and True, context Context({'COD_NEGOZIO': '0100107', 'exception_class': <class 'struttura._2_4.service.ServiceError'>, 'global_access_id': 1, 'entity': None, 'cod_negozio': '0100107', 'key': 'B2E_ENABLED', 'expression': (e.cod_negozio == '0100107') & (e.key == 'B2E_ENABLED')}))
DEBUG:mmfg.domain:querying source: filtering using source, ordering not required, pagination not required
DEBUG:mmfg.connection.sqlite:[conn:main] connected <config.db.PosWebDbConnection object at 0x10dde6400> in 0ms, transactions=False
DEBUG:mmfg.source.base:<backend.common.source.POSConfig object at 0x10ddb7f70> è connesso a main <config.db.PosWebDbConnection object at 0x10dde6400>
INFO:mmfg.connection.sqlite:[conn:main, 2ms, 1]  SELECT cod_negozio, data_modifica, key_name AS `key`, key_value AS `value` 				FROM store_config 		WHERE (cod_negozio = '0100107' AND key_name = 'B2E_ENABLED')    			 
DEBUG:mmfg.locator:global_access_id 1 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 1 removed from LocatorProvider [None]
INFO:root:Negozi enabled
INFO:root:['0100107']
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10ddb7f70> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 44] PRAGMA table_info("catalogo"); 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10ddb7f70>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10ddb7f70> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10ddb7f70>
DEBUG:mmfg.locator:Service RegoleCatalogo was requested with domain None and context {'COD_NEGOZIO': '0100107'}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10ddb7520>
DEBUG:mmfg.locator:Using provider LazyProvider(package="backend.catalog.service", attributes={})
DEBUG:mmfg.locator:Using service <backend.catalog.service.RegoleCatalogo object at 0x10ddb7f70>
DEBUG:mmfg.locator:Service StoreConfig was requested with domain <struttura._2_4.domain.Domain object at 0x10ddb7520> and context {'exception_class': <class 'Exception'>, 'global_access_id': 2}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10ddb7fd0>
DEBUG:mmfg.locator:Using provider LocatorProvider(package="None", attributes={})
DEBUG:mmfg.locator:global_access_id 2 not found in LocatorProvider for StoreConfig
DEBUG:mmfg.locator:Service StoreConfig was requested with domain None and context {'COD_NEGOZIO': '0100107', 'exception_class': <class 'Exception'>, 'global_access_id': 2}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10de594c0>
DEBUG:mmfg.locator:Using provider LazyProvider(package="backend.common.service", attributes={})
DEBUG:mmfg.locator:Using service <backend.common.service.StoreConfig object at 0x10de67580>
DEBUG:mmfg.locator:Using service <backend.common.service.StoreConfig object at 0x10de67580>
DEBUG:mmfg.domain:getsome of StoreConfig entities matching expression (e.cod_negozio == '0100107') & e.key._in({'COUNTRY_CODE', 'AVAILABLE_BRANDS'}); can't find in cache, using source
DEBUG:mmfg.locator:instantiating source POSConfig (asked entity StoreConfig, provider LazyProvider(package="backend.common.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), conditions True and True, context Context({'COD_NEGOZIO': '0100107', 'exception_class': <class 'Exception'>, 'global_access_id': 2, 'entity': None, 'expression': (e.cod_negozio == '0100107') & e.key._in({'COUNTRY_CODE', 'AVAILABLE_BRANDS'})}))
DEBUG:mmfg.domain:querying source: filtering using source, ordering not required, pagination not required
DEBUG:mmfg.source.base:<backend.common.source.POSConfig object at 0x10de678b0> è connesso a main <config.db.PosWebDbConnection object at 0x10dde6400>
INFO:mmfg.connection.sqlite:[conn:main, 0ms, 2]  SELECT cod_negozio, data_modifica, key_name AS `key`, key_value AS `value` 				FROM store_config 		WHERE (cod_negozio = '0100107' AND key_name IN ('COUNTRY_CODE', 'AVAILABLE_BRANDS'))    			 
DEBUG:mmfg.domain:getsome of RegolaCatalogo entities matching expression (e.nazione == 'IT') & (e.attivo == 1); can't find in cache, using source
DEBUG:mmfg.locator:instantiating source RegoleCatalogo (asked entity RegolaCatalogo, provider LazyProvider(package="backend.catalog.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), conditions True and True, context Context({'COD_NEGOZIO': '0100107', 'exception_class': <class 'struttura._2_4.service.ServiceError'>, 'global_access_id': 2, 'entity': None, 'nazione': 'IT', 'attivo': 1, 'expression': (e.nazione == 'IT') & (e.attivo == 1)}))
DEBUG:mmfg.domain:querying source: filtering using source, ordering not required, pagination not required
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10de99580> in 0ms, transactions=False
DEBUG:mmfg.source.base:<backend.catalog.source.RegoleCatalogo object at 0x10de99640> è connesso a catalogo <config.db.PosWebDbConnection object at 0x10de99580>
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 41]  SELECT brand, attivo, anno, collezione, data_modifica, nazione, stagione 				FROM regole_catalogo 		WHERE (nazione = 'IT' AND attivo = 1)    			 
DEBUG:mmfg.locator:Service StoreConfig was requested with domain <struttura._2_4.domain.Domain object at 0x10ddb7520> and context {'exception_class': <class 'Exception'>, 'global_access_id': 2}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10de67a00>
DEBUG:mmfg.locator:Using provider LocatorProvider(package="None", attributes={})
DEBUG:mmfg.locator:global_access_id 2 found in LocatorProvider for StoreConfig
DEBUG:mmfg.locator:Service StoreConfig was requested with domain <struttura._2_4.domain.Domain object at 0x10de594c0> and context {'exception_class': <class 'Exception'>, 'global_access_id': 2, 'COD_NEGOZIO': '0100107'}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10de99c10>
DEBUG:mmfg.locator:Using provider LazyProvider(package="backend.common.service", attributes={})
DEBUG:mmfg.locator:Using service <backend.common.service.StoreConfig object at 0x10de996d0>
DEBUG:mmfg.locator:Using service <backend.common.service.StoreConfig object at 0x10de996d0>
DEBUG:mmfg.domain:getsome of StoreConfig entities matching expression (e.cod_negozio == '0100107') & (e.key == 'COUNTRY_CODE'); found result in cache (with broader expression (e.cod_negozio == '0100107') & e.key._in({'COUNTRY_CODE', 'AVAILABLE_BRANDS'}))
DEBUG:mmfg.domain:getsome of RegolaCatalogoForzatura entities matching expression (e.nazione == 'IT') & (e.attivo == 1); can't find in cache, using source
DEBUG:mmfg.locator:instantiating source RegoleCatalogoForzature (asked entity RegolaCatalogoForzatura, provider LazyProvider(package="backend.catalog.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), conditions True and True, context Context({'COD_NEGOZIO': '0100107', 'exception_class': <class 'struttura._2_4.service.ServiceError'>, 'global_access_id': 2, 'entity': None, 'nazione': 'IT', 'attivo': 1, 'expression': (e.nazione == 'IT') & (e.attivo == 1)}))
DEBUG:mmfg.domain:querying source: filtering using source, ordering not required, pagination not required
DEBUG:mmfg.source.base:<backend.catalog.source.RegoleCatalogoForzature object at 0x10debdca0> è connesso a catalogo <config.db.PosWebDbConnection object at 0x10de99580>
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0]  SELECT brand, attivo, anno, collezione, forzatura, data_modifica, nazione, stagione 				FROM regole_catalogo_forzature 				WHERE (nazione = 'IT' AND attivo = 1)    			 
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [<backend.common.service.StoreConfig object at 0x10de67580>]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 2 removed from LocatorProvider [None]
INFO:root:Composizione tabella _m_20240719162836_243_catalogo_b2e
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 7ms, 0] CREATE TABLE _m_20240719162836_243_catalogo_b2e ( 			sku varchar(14) NOT NULL,modello varchar(10) NOT NULL,variante varchar(3) NOT NULL,taglia varchar(2) NOT NULL,pezzo varchar(1) NOT NULL,nome varchar(8) NOT NULL,annostag varchar(5) NOT NULL,societa varchar(2) NOT NULL,collezione varchar(5) NOT NULL,classe varchar(2) NOT NULL,stagionale varchar(15) NOT NULL,categoria_vertex varchar(2) NOT NULL,codice_taglia varchar(10) NOT NULL,appeso_steso varchar(2) NOT NULL,codice_composizione varchar(2) NOT NULL,n_componenti_pacco integer NOT NULL,peso integer NOT NULL,composizione varchar(1000) NOT NULL,composizione_varia varchar(1000) NOT NULL,flag_promo integer NOT NULL,flag_salvato integer NOT NULL,flag_divisa integer NOT NULL,colore varchar(6) NOT NULL,desc_colore varchar(255) NOT NULL,desc_taglia varchar(255) NOT NULL,desc_classe varchar(255) NOT NULL,desc_collezione varchar(255) NOT NULL,desc_estesa varchar(255) NOT NULL,ean varchar(255) NOT NULL,sku_padre varchar(14) NOT NULL,numero_pezzi integer NOT NULL,cod_marchio varchar(255) NOT NULL,cod_marchio_originale varchar(255) NOT NULL,cod_sottocategoria_b2c varchar(5) DEFAULT NULL,raggruppamento_colore varchar(50) NOT NULL DEFAULT '',validita_variante varchar(5) DEFAULT NULL,data_consegna varchar(8) DEFAULT NULL,versione_modello varchar(1) NOT NULL,main_line varchar(2) NOT NULL,desc_main_line varchar(255) NOT NULL,indice_tg integer DEFAULT NULL,modello_principale varchar(10) NOT NULL,nome_principale varchar(8) NOT NULL,data_modifica timestamp DEFAULT CURRENT_TIMESTAMP,all_varianti varchar(500) NOT NULL,all_raggruppamenti_colore varchar(500) NOT NULL,all_sku text NOT NULL,all_sizes varchar(1000) NOT NULL 			, PRIMARY KEY (modello_principale) 		) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE _m_20240719162836_243_catalogo_b2e (\\n\\t\\t\\tsku varchar(14) NOT NULL,modello varchar(10) NOT NULL,variante varchar(3) NOT NULL,taglia varchar(2) NOT NULL,pezzo varchar(1) NOT NULL,nome varchar(8) NOT NULL,annostag varchar(5) NOT NULL,societa varchar(2) NOT NULL,collezione varchar(5) NOT NULL,classe varchar(2) NOT NULL,stagionale varchar(15) NOT NULL,categoria_vertex varchar(2) NOT NULL,codice_taglia varchar(10) NOT NULL,appeso_steso varchar(2) NOT NULL,codice_composizione varchar(2) NOT NULL,n_componenti_pacco integer NOT NULL,peso integer NOT NULL,composizione varchar(1000) NOT NULL,composizione_varia varchar(1000) NOT NULL,flag_promo integer NOT NULL,flag_salvato integer NOT NULL,flag_divisa integer NOT NULL,colore varchar(6) NOT NULL,desc_colore varchar(255) NOT NULL,desc_taglia varchar(255) NOT NULL,desc_classe varchar(255) NOT NULL,desc_collezione varchar(255) NOT NULL,desc_estesa varchar(255) NOT NULL,ean varchar(255) NOT NULL,sku_padre varchar(14) NOT NULL,numero_pezzi integer NOT NULL,cod_marchio varchar(255) NOT NULL,cod_marchio_originale varchar(255) NOT NULL,cod_sottocategoria_b2c varchar(5) DEFAULT NULL,raggruppamento_colore varchar(50) NOT NULL DEFAULT \'\',validita_variante varchar(5) DEFAULT NULL,data_consegna varchar(8) DEFAULT NULL,versione_modello varchar(1) NOT NULL,main_line varchar(2) NOT NULL,desc_main_line varchar(255) NOT NULL,indice_tg integer DEFAULT NULL,modello_principale varchar(10) NOT NULL,nome_principale varchar(8) NOT NULL,data_modifica timestamp DEFAULT CURRENT_TIMESTAMP,all_varianti varchar(500) NOT NULL,all_raggruppamenti_colore varchar(500) NOT NULL,all_sku text NOT NULL,all_sizes varchar(1000) NOT NULL\\n\\t\\t\\t, PRIMARY KEY (modello_principale)\\n\\t\\t)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 111ms, 0] INSERT INTO _m_20240719162836_243_catalogo_b2e  			SELECT DISTINCT c.* , GROUP_CONCAT(DISTINCT c.variante), GROUP_CONCAT(DISTINCT c.raggruppamento_colore), GROUP_CONCAT(DISTINCT c.sku), GROUP_CONCAT(DISTINCT(c.societa || '.' || c.codice_taglia || '.' || IFNULL(c.indice_tg, 'null'))) 		FROM catalogo c 			INNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "20240719" 			WHERE 1  AND c.sku_padre = "" AND c.validita_variante IN ("V", "B") AND c.versione_modello = "V" 				AND c.cod_marchio in ('MC') AND ((c.cod_marchio_originale IN('SP','WE','MM') AND c.annostag='20212')OR(c.cod_marchio_originale IN('SP','WE','MM') AND c.annostag='20221')OR(c.cod_marchio_originale IN('PB') AND c.annostag='20241')OR(c.cod_marchio_originale IN('PB') AND c.annostag='20242')OR(c.cod_marchio_originale='MM' AND c.annostag='20171' AND c.collezione IN('82'))OR(c.cod_marchio_originale='MC' AND c.annostag='20241' AND c.collezione IN('65','88','64','89','62','83','82','68','84','66','86','61','67','81','87','63'))OR(c.cod_marchio_originale='MC' AND c.annostag='20242' AND c.collezione IN('65','88','89','64','62','83','82','68','84','66','86','61','67','81','87','63'))) 		 AND p.cod_negozio in ('0100107') 			GROUP BY c.modello_principale 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO _m_20240719162836_243_catalogo_b2e \\n\\t\\t\\tSELECT DISTINCT c.* , GROUP_CONCAT(DISTINCT c.variante), GROUP_CONCAT(DISTINCT c.raggruppamento_colore), GROUP_CONCAT(DISTINCT c.sku), GROUP_CONCAT(DISTINCT(c.societa || \'.\' || c.codice_taglia || \'.\' || IFNULL(c.indice_tg, \'null\')))\\n\\t\\t\\tFROM catalogo c\\n\\t\\t\\tINNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo=\\"V\\" AND p.data_inizio_validita <= \\"20240719\\"\\n\\t\\t\\tWHERE 1  AND c.sku_padre = \\"\\" AND c.validita_variante IN (\\"V\\", \\"B\\") AND c.versione_modello = \\"V\\"\\n\\t\\t\\t\\tAND c.cod_marchio in (\'MC\') AND ((c.cod_marchio_originale IN(\'SP\',\'WE\',\'MM\') AND c.annostag=\'20212\')OR(c.cod_marchio_originale IN(\'SP\',\'WE\',\'MM\') AND c.annostag=\'20221\')OR(c.cod_marchio_originale IN(\'PB\') AND c.annostag=\'20241\')OR(c.cod_marchio_originale IN(\'PB\') AND c.annostag=\'20242\')OR(c.cod_marchio_originale=\'MM\' AND c.annostag=\'20171\' AND c.collezione IN(\'82\'))OR(c.cod_marchio_originale=\'MC\' AND c.annostag=\'20241\' AND c.collezione IN(\'65\',\'88\',\'64\',\'89\',\'62\',\'83\',\'82\',\'68\',\'84\',\'66\',\'86\',\'61\',\'67\',\'81\',\'87\',\'63\'))OR(c.cod_marchio_originale=\'MC\' AND c.annostag=\'20242\' AND c.collezione IN(\'65\',\'88\',\'89\',\'64\',\'62\',\'83\',\'82\',\'68\',\'84\',\'66\',\'86\',\'61\',\'67\',\'81\',\'87\',\'63\')))\\n\\t\\t AND p.cod_negozio in (\'0100107\')\\n\\t\\t\\tGROUP BY c.modello_principale"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_mod_pz_ind ON _m_20240719162836_243_catalogo_b2e(modello,pezzo) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_mod_pz_ind ON _m_20240719162836_243_catalogo_b2e(modello,pezzo)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_as_soc_coll_ind ON _m_20240719162836_243_catalogo_b2e(annostag,societa,collezione,desc_classe) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_as_soc_coll_ind ON _m_20240719162836_243_catalogo_b2e(annostag,societa,collezione,desc_classe)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_classe_desc_ind ON _m_20240719162836_243_catalogo_b2e(classe,desc_classe) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_classe_desc_ind ON _m_20240719162836_243_catalogo_b2e(classe,desc_classe)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_nome ON _m_20240719162836_243_catalogo_b2e(nome) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_nome ON _m_20240719162836_243_catalogo_b2e(nome)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_nome_principale ON _m_20240719162836_243_catalogo_b2e(nome_principale) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_nome_principale ON _m_20240719162836_243_catalogo_b2e(nome_principale)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_modello_principale ON _m_20240719162836_243_catalogo_b2e(modello_principale) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_modello_principale ON _m_20240719162836_243_catalogo_b2e(modello_principale)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX o_20240719162836_67_catalogo_b2e_cod_marchio_classe ON _m_20240719162836_243_catalogo_b2e(cod_marchio,classe) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX o_20240719162836_67_catalogo_b2e_cod_marchio_classe ON _m_20240719162836_243_catalogo_b2e(cod_marchio,classe)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Eliminazione catalogo_b2e
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] DROP TABLE IF EXISTS catalogo_b2e 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Rinominazione _m_20240719162836_243_catalogo_b2e
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 4ms, 0] ALTER TABLE _m_20240719162836_243_catalogo_b2e RENAME TO catalogo_b2e 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "ALTER TABLE _m_20240719162836_243_catalogo_b2e RENAME TO catalogo_b2e"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Composizione tabella _d_20240719162836_515_catalogo_b2e_prezzi
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] CREATE TABLE _d_20240719162836_515_catalogo_b2e_prezzi ( 			modello_principale varchar(10) NOT NULL,cod_negozio varchar(7) NOT NULL,prezzo_v decimal(13, 2) NOT NULL 			, PRIMARY KEY (modello_principale,cod_negozio) 		) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE _d_20240719162836_515_catalogo_b2e_prezzi (\\n\\t\\t\\tmodello_principale varchar(10) NOT NULL,cod_negozio varchar(7) NOT NULL,prezzo_v decimal(13, 2) NOT NULL\\n\\t\\t\\t, PRIMARY KEY (modello_principale,cod_negozio)\\n\\t\\t)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 6ms, 0] INSERT INTO _d_20240719162836_515_catalogo_b2e_prezzi  			SELECT DISTINCT c.modello_principale, p.cod_negozio , REPLACE(MAX(p.data_inizio_validita || "|" || p.prezzo), MAX(p.data_inizio_validita || "|"), "") 			FROM catalogo_b2e c 			INNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "20240719" 			WHERE 1  AND p.cod_negozio in ('0100107') 			GROUP BY c.modello_principale, p.cod_negozio 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO _d_20240719162836_515_catalogo_b2e_prezzi \\n\\t\\t\\tSELECT DISTINCT c.modello_principale, p.cod_negozio , REPLACE(MAX(p.data_inizio_validita || \\"|\\" || p.prezzo), MAX(p.data_inizio_validita || \\"|\\"), \\"\\")\\n\\t\\t\\tFROM catalogo_b2e c\\n\\t\\t\\tINNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo=\\"V\\" AND p.data_inizio_validita <= \\"20240719\\"\\n\\t\\t\\tWHERE 1  AND p.cod_negozio in (\'0100107\')\\n\\t\\t\\tGROUP BY c.modello_principale, p.cod_negozio"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Eliminazione catalogo_b2e_prezzi
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] DROP TABLE IF EXISTS catalogo_b2e_prezzi 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_prezzi"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
INFO:root:Rinominazione _d_20240719162836_515_catalogo_b2e_prezzi
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 3ms, 0] ALTER TABLE _d_20240719162836_515_catalogo_b2e_prezzi RENAME TO catalogo_b2e_prezzi 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "ALTER TABLE _d_20240719162836_515_catalogo_b2e_prezzi RENAME TO catalogo_b2e_prezzi"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
INFO:root:Composizione tabella _y_20240719162836_240_catalogo_b2e_varianti
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] CREATE TABLE _y_20240719162836_240_catalogo_b2e_varianti ( 			sku varchar(14) NOT NULL,modello varchar(10) NOT NULL,variante varchar(3) NOT NULL,taglia varchar(2) NOT NULL,pezzo varchar(1) NOT NULL,nome varchar(8) NOT NULL,annostag varchar(5) NOT NULL,societa varchar(2) NOT NULL,collezione varchar(5) NOT NULL,classe varchar(2) NOT NULL,stagionale varchar(15) NOT NULL,categoria_vertex varchar(2) NOT NULL,codice_taglia varchar(10) NOT NULL,appeso_steso varchar(2) NOT NULL,codice_composizione varchar(2) NOT NULL,n_componenti_pacco integer NOT NULL,peso integer NOT NULL,composizione varchar(1000) NOT NULL,composizione_varia varchar(1000) NOT NULL,flag_promo integer NOT NULL,flag_salvato integer NOT NULL,flag_divisa integer NOT NULL,colore varchar(6) NOT NULL,desc_colore varchar(255) NOT NULL,desc_taglia varchar(255) NOT NULL,desc_classe varchar(255) NOT NULL,desc_collezione varchar(255) NOT NULL,desc_estesa varchar(255) NOT NULL,ean varchar(255) NOT NULL,sku_padre varchar(14) NOT NULL,numero_pezzi integer NOT NULL,cod_marchio varchar(255) NOT NULL,cod_marchio_originale varchar(255) NOT NULL,cod_sottocategoria_b2c varchar(5) DEFAULT NULL,raggruppamento_colore varchar(50) NOT NULL DEFAULT '',validita_variante varchar(5) DEFAULT NULL,data_consegna varchar(8) DEFAULT NULL,versione_modello varchar(1) NOT NULL,main_line varchar(2) NOT NULL,desc_main_line varchar(255) NOT NULL,indice_tg integer DEFAULT NULL,modello_principale varchar(10) NOT NULL,nome_principale varchar(8) NOT NULL,data_modifica timestamp DEFAULT CURRENT_TIMESTAMP,campi_aggregati varchar(5000) NOT NULL 		, PRIMARY KEY (variante,modello_principale) 		) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE _y_20240719162836_240_catalogo_b2e_varianti (\\n\\t\\t\\tsku varchar(14) NOT NULL,modello varchar(10) NOT NULL,variante varchar(3) NOT NULL,taglia varchar(2) NOT NULL,pezzo varchar(1) NOT NULL,nome varchar(8) NOT NULL,annostag varchar(5) NOT NULL,societa varchar(2) NOT NULL,collezione varchar(5) NOT NULL,classe varchar(2) NOT NULL,stagionale varchar(15) NOT NULL,categoria_vertex varchar(2) NOT NULL,codice_taglia varchar(10) NOT NULL,appeso_steso varchar(2) NOT NULL,codice_composizione varchar(2) NOT NULL,n_componenti_pacco integer NOT NULL,peso integer NOT NULL,composizione varchar(1000) NOT NULL,composizione_varia varchar(1000) NOT NULL,flag_promo integer NOT NULL,flag_salvato integer NOT NULL,flag_divisa integer NOT NULL,colore varchar(6) NOT NULL,desc_colore varchar(255) NOT NULL,desc_taglia varchar(255) NOT NULL,desc_classe varchar(255) NOT NULL,desc_collezione varchar(255) NOT NULL,desc_estesa varchar(255) NOT NULL,ean varchar(255) NOT NULL,sku_padre varchar(14) NOT NULL,numero_pezzi integer NOT NULL,cod_marchio varchar(255) NOT NULL,cod_marchio_originale varchar(255) NOT NULL,cod_sottocategoria_b2c varchar(5) DEFAULT NULL,raggruppamento_colore varchar(50) NOT NULL DEFAULT \'\',validita_variante varchar(5) DEFAULT NULL,data_consegna varchar(8) DEFAULT NULL,versione_modello varchar(1) NOT NULL,main_line varchar(2) NOT NULL,desc_main_line varchar(255) NOT NULL,indice_tg integer DEFAULT NULL,modello_principale varchar(10) NOT NULL,nome_principale varchar(8) NOT NULL,data_modifica timestamp DEFAULT CURRENT_TIMESTAMP,campi_aggregati varchar(5000) NOT NULL\\n\\t\\t\\t, PRIMARY KEY (variante,modello_principale)\\n\\t\\t)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 113ms, 0] INSERT INTO _y_20240719162836_240_catalogo_b2e_varianti  			SELECT DISTINCT c.* , '[' || GROUP_CONCAT(DISTINCT('["' || c.sku || '","' || c.taglia || '","' || c.desc_taglia || '",' || IFNULL(c.indice_tg, 'null') || ',"' || c.ean || '"' || ']')) || ']' 			FROM catalogo c 		INNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "20240719" 			WHERE 1  AND c.sku_padre = "" AND c.validita_variante IN ("V", "B") AND c.versione_modello = "V" 				AND c.cod_marchio in ('MC') AND ((c.cod_marchio_originale IN('SP','WE','MM') AND c.annostag='20212')OR(c.cod_marchio_originale IN('SP','WE','MM') AND c.annostag='20221')OR(c.cod_marchio_originale IN('PB') AND c.annostag='20241')OR(c.cod_marchio_originale IN('PB') AND c.annostag='20242')OR(c.cod_marchio_originale='MM' AND c.annostag='20171' AND c.collezione IN('82'))OR(c.cod_marchio_originale='MC' AND c.annostag='20241' AND c.collezione IN('65','88','64','89','62','83','82','68','84','66','86','61','67','81','87','63'))OR(c.cod_marchio_originale='MC' AND c.annostag='20242' AND c.collezione IN('65','88','89','64','62','83','82','68','84','66','86','61','67','81','87','63'))) 		 AND p.cod_negozio in ('0100107') 			GROUP BY c.modello_principale, c.variante 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO _y_20240719162836_240_catalogo_b2e_varianti \\n\\t\\t\\tSELECT DISTINCT c.* , \'[\' || GROUP_CONCAT(DISTINCT(\'[\\"\' || c.sku || \'\\",\\"\' || c.taglia || \'\\",\\"\' || c.desc_taglia || \'\\",\' || IFNULL(c.indice_tg, \'null\') || \',\\"\' || c.ean || \'\\"\' || \']\')) || \']\'\\n\\t\\t\\tFROM catalogo c\\n\\t\\t\\tINNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo=\\"V\\" AND p.data_inizio_validita <= \\"20240719\\"\\n\\t\\t\\tWHERE 1  AND c.sku_padre = \\"\\" AND c.validita_variante IN (\\"V\\", \\"B\\") AND c.versione_modello = \\"V\\"\\n\\t\\t\\t\\tAND c.cod_marchio in (\'MC\') AND ((c.cod_marchio_originale IN(\'SP\',\'WE\',\'MM\') AND c.annostag=\'20212\')OR(c.cod_marchio_originale IN(\'SP\',\'WE\',\'MM\') AND c.annostag=\'20221\')OR(c.cod_marchio_originale IN(\'PB\') AND c.annostag=\'20241\')OR(c.cod_marchio_originale IN(\'PB\') AND c.annostag=\'20242\')OR(c.cod_marchio_originale=\'MM\' AND c.annostag=\'20171\' AND c.collezione IN(\'82\'))OR(c.cod_marchio_originale=\'MC\' AND c.annostag=\'20241\' AND c.collezione IN(\'65\',\'88\',\'64\',\'89\',\'62\',\'83\',\'82\',\'68\',\'84\',\'66\',\'86\',\'61\',\'67\',\'81\',\'87\',\'63\'))OR(c.cod_marchio_originale=\'MC\' AND c.annostag=\'20242\' AND c.collezione IN(\'65\',\'88\',\'89\',\'64\',\'62\',\'83\',\'82\',\'68\',\'84\',\'66\',\'86\',\'61\',\'67\',\'81\',\'87\',\'63\')))\\n\\t\\t AND p.cod_negozio in (\'0100107\')\\n\\t\\t\\tGROUP BY c.modello_principale, c.variante"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_mod_pz_ind ON _y_20240719162836_240_catalogo_b2e_varianti(modello,pezzo) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_mod_pz_ind ON _y_20240719162836_240_catalogo_b2e_varianti(modello,pezzo)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 3ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_as_soc_coll_ind ON _y_20240719162836_240_catalogo_b2e_varianti(annostag,societa,collezione,desc_classe) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_as_soc_coll_ind ON _y_20240719162836_240_catalogo_b2e_varianti(annostag,societa,collezione,desc_classe)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_classe_desc_ind ON _y_20240719162836_240_catalogo_b2e_varianti(classe,desc_classe) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_classe_desc_ind ON _y_20240719162836_240_catalogo_b2e_varianti(classe,desc_classe)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_nome ON _y_20240719162836_240_catalogo_b2e_varianti(nome) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_nome ON _y_20240719162836_240_catalogo_b2e_varianti(nome)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_nome_principale ON _y_20240719162836_240_catalogo_b2e_varianti(nome_principale) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_nome_principale ON _y_20240719162836_240_catalogo_b2e_varianti(nome_principale)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_modello_principale ON _y_20240719162836_240_catalogo_b2e_varianti(modello_principale) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_modello_principale ON _y_20240719162836_240_catalogo_b2e_varianti(modello_principale)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_cod_marchio_classe ON _y_20240719162836_240_catalogo_b2e_varianti(cod_marchio,classe,modello_principale) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE INDEX u_20240719162836_22_catalogo_b2e_varianti_cod_marchio_classe ON _y_20240719162836_240_catalogo_b2e_varianti(cod_marchio,classe,modello_principale)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Eliminazione catalogo_b2e_varianti
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] DROP TABLE IF EXISTS catalogo_b2e_varianti 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_varianti"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Rinominazione _y_20240719162836_240_catalogo_b2e_varianti
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 3ms, 0] ALTER TABLE _y_20240719162836_240_catalogo_b2e_varianti RENAME TO catalogo_b2e_varianti 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "ALTER TABLE _y_20240719162836_240_catalogo_b2e_varianti RENAME TO catalogo_b2e_varianti"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Composizione tabella _i_20240719162836_72_catalogo_b2e_varianti_prezzi
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] CREATE TABLE _i_20240719162836_72_catalogo_b2e_varianti_prezzi ( 			modello_principale varchar(10) NOT NULL,variante varchar(3) NOT NULL,cod_negozio varchar(7) NOT NULL,prezzo_s decimal(13, 2),prezzo_p decimal(13, 2),prezzo_c decimal(13, 2) 			, PRIMARY KEY (modello_principale,variante,cod_negozio) 		) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE _i_20240719162836_72_catalogo_b2e_varianti_prezzi (\\n\\t\\t\\tmodello_principale varchar(10) NOT NULL,variante varchar(3) NOT NULL,cod_negozio varchar(7) NOT NULL,prezzo_s decimal(13, 2),prezzo_p decimal(13, 2),prezzo_c decimal(13, 2)\\n\\t\\t\\t, PRIMARY KEY (modello_principale,variante,cod_negozio)\\n\\t\\t)"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 7ms, 0] INSERT INTO _i_20240719162836_72_catalogo_b2e_varianti_prezzi  			SELECT DISTINCT c.modello_principale, c.variante, p.cod_negozio , NULL, NULL, NULL 			FROM catalogo_b2e_varianti c 			INNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "20240719" 			WHERE 1  AND p.cod_negozio in ('0100107') 			GROUP BY c.modello_principale, c.variante, p.cod_negozio 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdeb0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO _i_20240719162836_72_catalogo_b2e_varianti_prezzi \\n\\t\\t\\tSELECT DISTINCT c.modello_principale, c.variante, p.cod_negozio , NULL, NULL, NULL\\n\\t\\t\\tFROM catalogo_b2e_varianti c\\n\\t\\t\\tINNER JOIN prezzi p  ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo=\\"V\\" AND p.data_inizio_validita <= \\"20240719\\"\\n\\t\\t\\tWHERE 1  AND p.cod_negozio in (\'0100107\')\\n\\t\\t\\tGROUP BY c.modello_principale, c.variante, p.cod_negozio"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdeb0>
INFO:root:Eliminazione catalogo_b2e_varianti_prezzi
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] DROP TABLE IF EXISTS catalogo_b2e_varianti_prezzi 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_varianti_prezzi"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
INFO:root:Rinominazione _i_20240719162836_72_catalogo_b2e_varianti_prezzi
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 3ms, 0] ALTER TABLE _i_20240719162836_72_catalogo_b2e_varianti_prezzi RENAME TO catalogo_b2e_varianti_prezzi 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debdee0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debdee0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "ALTER TABLE _i_20240719162836_72_catalogo_b2e_varianti_prezzi RENAME TO catalogo_b2e_varianti_prezzi"}', '2024-07-19 14:28:36'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debdee0>
INFO:root:Inserimento dei prezzi di saldo S P C su tabella catalogo_b2e_varianti
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10debde80> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 5ms, 948] SELECT DISTINCT modello, pezzo 				FROM catalogo_b2e_varianti c 				JOIN catalogo_b2e_varianti_prezzi cp on (c.modello = cp.modello_principale and c.variante = cp.variante) 				where cp.cod_negozio = ? (params: ('0100107',))
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10debde80>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10debde80> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10debde80>
DEBUG:mmfg.locator:Service StoreConfig was requested with domain None and context {'COD_NEGOZIO': '0100107'}
DEBUG:mmfg.locator:Using domain <struttura._2_4.domain.Domain object at 0x10debdee0>
DEBUG:mmfg.locator:Using provider LazyProvider(package="backend.common.service", attributes={})
DEBUG:mmfg.locator:Using service <backend.common.service.StoreConfig object at 0x10debdf70>
DEBUG:mmfg.domain:getsome of StoreConfig entities matching expression (e.cod_negozio == '0100107') & e.key._in({'DATA_FINE_PREZZI_ENABLED', 'OWNER', 'LISTINO_ESTESO_ENABLED'}); can't find in cache, using source
DEBUG:mmfg.locator:instantiating source POSConfig (asked entity StoreConfig, provider LazyProvider(package="backend.common.source", attributes={'connection_parameters': {'dbdir': '/rnd/pos/mmfg/posweb/var/database'}}), conditions True and True, context Context({'COD_NEGOZIO': '0100107', 'exception_class': <class 'struttura._2_4.service.ServiceError'>, 'global_access_id': 3, 'entity': None, 'expression': (e.cod_negozio == '0100107') & e.key._in({'DATA_FINE_PREZZI_ENABLED', 'OWNER', 'LISTINO_ESTESO_ENABLED'})}))
DEBUG:mmfg.domain:querying source: filtering using source, ordering not required, pagination not required
DEBUG:mmfg.source.base:<backend.common.source.POSConfig object at 0x10e322130> è connesso a main <config.db.PosWebDbConnection object at 0x10dde6400>
INFO:mmfg.connection.sqlite:[conn:main, 0ms, 3]  SELECT cod_negozio, data_modifica, key_name AS `key`, key_value AS `value` 				FROM store_config 		WHERE (cod_negozio = '0100107' AND key_name IN ('DATA_FINE_PREZZI_ENABLED', 'OWNER', 'LISTINO_ESTESO_ENABLED'))    			 
DEBUG:mmfg.locator:global_access_id 3 removed from LocatorProvider [None]
DEBUG:mmfg.locator:global_access_id 3 removed from LocatorProvider [None]
INFO:root:Verifica dei prezzi di saldo per pezzo = 0, processing 800/948 modelli (negozio 0100107)
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10e322190> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 46ms, 4051] SELECT IFNULL(prezzo,0) AS prezzo_listino, IFNULL(prezzo,0) AS prezzo_attuale, IFNULL(perc,0) AS perc_attuale, 			divisa, IFNULL(tipo_prezzo,'') AS tipo_prezzo, data_inizio_validita, data_fine_validita, modello, 				variante, id_listino 		FROM prezzi 		WHERE cod_negozio = ? 		AND modello IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 		AND pezzo = ? 		AND tipo_prezzo IN (?,?,?,?,?,?,?) (params: ('0100107', '6011014102', '6011014202', '6011024102', '6011034102', '6011044102', '6011064102', '6016014102', '6016014302', '6016014402', '6016034302', '6016054402', '6016134402', '6016144402', '6016154402', '6021014302', '6021024302', '6021034302', '6026014302', '6036014402', '6041014302', '6041014502', '6041024102', '6041024202', '6041024302', '6041024402', '6041034202', '6041034402', '6041044102', '6041044202', '6041044302', '6041044402', '6041054102', '6041054402', '6041064402', '6041074102', '6041084302', '6046014202', '6046014402', '6046014502', '6046024102', '6046024202', '6046024302', '6046034102', '6046034202', '6046034302', '6046034402', '6046044102', '6046044302', '6046044402', '6046054102', '6046054402', '6046064102', '6046074102', '6081014102', '6081024102', '6081034102', '6081044102', '6081044302', '6081054102', '6081054302', '6081064102', '6081064302', '6081074302', '6086014102', '6086014202', '6086014302', '6086024102', '6086024202', '6086024302', '6086034202', '6086034302', '6086034402', '6086044402', '6086054402', '6086074402', '6101024302', '6101034402', '6101044302', '6101044402', '6101054102', '6101064302', '6101074402', '6101084302', '6101094302', '6106014102', '6106014402', '6106014502', '6106014802', '6106024102', '6106034102', '6106034402', '6106044102', '6106044302', '6106054402', '6106064102', '6106074102', '6111014202', '6111014502', '6111024102', '6111024402', '6111024502', '6111034102', '6111034302', '6111044102', '6111044202', '6111044302', '6111044402', '6111054102', '6111054202', '6111054402', '6111064202', '6111064302', '6111064402', '6111074302', '6111074402', '6111084302', '6111084402', '6111094302', '6116014102', '6116014202', '6116014302', '6116014502', '6116024102', '6116024402', '6116034102', '6116034202', '6116034302', '6116044202', '6116044302', '6116044402', '6116054102', '6116054302', '6116064102', '6116064302', '6116074102', '6116084102', '6116094102', '6131014402', '6131014502', '6131024102', '6131024302', '6131024402', '6131024502', '6131034102', '6131034302', '6131034402', '6131034502', '6131044102', '6131044302', '6131054102', '6131054202', '6131054302', '6131054402', '6131064102', '6131064202', '6131064302', '6131064402', '6131074102', '6131074202', '6131074302', '6131074402', '6131084102', '6131084202', '6131084402', '6131094102', '6131104102', '6131104402', '6131114102', '6136014202', '6136014502', '6136024102', '6136024202', '6136024302', '6136024402', '6136034102', '6136034202', '6136034302', '6136044102', '6136044302', '6136044402', '6136054102', '6136054302', '6136054402', '6136064102', '6136064402', '6136074102', '6136074302', '6136084102', '6136084302', '6136094102', '6136094302', '6136094402', '6136104302', '6136104402', '6136114402', '6136124402', '6141014402', '6141024502', '6146014102', '6146014402', '6146024102', '6151014102', '6151024202', '6156014102', '6156014202', '6156024102', '6161014502', '6161024302', '6161034102', '6166014102', '6166014402', '6166034102', '6166044102', '6166054102', '6181014102', '6181024102', '6181034302', '6181044202', '6181044302', '6181054202', '6181054302', '6181064302', '6186014302', '6186024102', '6186024802', '6186034102', '6186054102', '6186064102', '6186074102', '6186084102', '6191014502', '6191024302', '6221014402', '6221014502', '6221024202', '6221024302', '6221034202', '6221044302', '6221044402', '6221054502', '6221064402', '6221074402', '6221084102', '6221084402', '6221094302', '6221094402', '6221104402', '6221114102', '6221124102', '6221144102', '6221154102', '6221154402', '6221164102', '6221164402', '6221174402', '6226014302', '6226014402', '6226014502', '6226024102', '6226024402', '6226034102', '6226034502', '6226044102', '6226054102', '6226054402', '6226074102', '6226084102', '6226094102', '6226104102', '6226114102', '6226134102', '6241014302', '6241024102', '6241024402', '6241034402', '6246014102', '6246014502', '6291014602', '6296014702', '6296024702', '6306014102', '6316014402', '6321014302', '6321014402', '6326014102', '6326014302', '6326014402', '6326034102', '6331014102', '6331024102', '6341014102', '6341014302', '6341014402', '6341024102', '6341034102', '6341044102', '6346014102', '6346014202', '6346014302', '6346014402', '6346014802', '6346024102', '6346024302', '6346024802', '6346034102', '6346044102', '6346054102', '6356014402', '6356014802', '6361014102', '6361014202', '6361014302', '6361014402', '6361024102', '6361024302', '6361024402', '6361034102', '6361034202', '6361034302', '6361044102', '6361044202', '6361054102', '6361054302', '6361064102', '6361064202', '6361064302', '6361074102', '6361074302', '6361084102', '6361084202', '6361104102', '6361114102', '6366014102', '6366014202', '6366014302', '6366014402', '6366014502', '6366014802', '6366024102', '6366024202', '6366024302', '6366024402', '6366024502', '6366024802', '6366034102', '6366034302', '6366034402', '6366034802', '6366044102', '6366044302', '6366044402', '6366044802', '6366054102', '6366054302', '6366054402', '6366054802', '6366064102', '6366064302', '6366064402', '6366064802', '6366074102', '6366074302', '6366074402', '6366084102', '6366084302', '6366084402', '6366094102', '6366094402', '6366104402', '6366114402', '6366124402', '6366134402', '6371014402', '6376014102', '6381014102', '6386014402', '6386024302', '6406014102', '6406014302', '6441014102', '6441034202', '6446014102', '6446014302', '6446024102', '6446024302', '6481014202', '6486014102', '6486014202', '6486014402', '6486024202', '6486024402', '6486034402', '6486044402', '6491014202', '6496014402', '6496034402', '6496044402', '6501014602', '6501014702', '6501024602', '6501034602', '6501034702', '6501044702', '6501054702', '6501064702', '6506014602', '6506014702', '6506024602', '6506024702', '6506034602', '6506034702', '6506044702', '6511014602', '6511014702', '6511024702', '6511034602', '6511034702', '6511044602', '6511044702', '6511054602', '6511054702', '6511064602', '6511064702', '6516014602', '6516014702', '6516014802', '6516024602', '6516024702', '6516034602', '6516034702', '6516044602', '6516044702', '6516054602', '6516064602', '6521014602', '6521014702', '6521024602', '6521034602', '6521044702', '6521054702', '6521064702', '6521084702', '6521094702', '6526014602', '6526014702', '6526024602', '6526024702', '6526034602', '6526034702', '6526044602', '6528014702', '6528024702', '6541014602', '6541014702', '6541024602', '6541024702', '6541034602', '6541034702', '6541044702', '6546014602', '6546014702', '6546024602', '6546024702', '6546034602', '6546034702', '6546044702', '6571014602', '6571014702', '6571024702', '6571034602', '6576014602', '6576014702', '6576024702', '6576034702', '6576044702', '6611014602', '6616014702', '6616024702', '6621014102', '6621014202', '6621014302', '6621014502', '6621014802', '6621024102', '6621024402', '6621034302', '6621034402', '6621044102', '6621044402', '6621054402', '6621064402', '6621074102', '6621074402', '6621084102', '6626014102', '6626014202', '6626014402', '6626014502', '6626024102', '6626024302', '6626024402', '6626024502', '6626034102', '6626034402', '6626034502', '6626044102', '6626054102', '6626064102', '6626074102', '6626094102', '6626104102', '6626114102', '6631014402', '6631024102', '6636014102', '6641014102', '6641014402', '6646014102', '6716014702', '6736014602', '6736014702', '6751014702', '6751014802', '6751024602', '6751024802', '6751034602', '6751034802', '6751044802', '6756014602', '6761014602', '6766014602', '6766014702', '6771014102', '6771014302', '6771014402', '6771024302', '6771024402', '6771034302', '6776014102', '6776014202', '6776014302', '6776014402', '6776014502', '6776024102', '6776024402', '6776034102', '6781014102', '6781014202', '6781014302', '6781014402', '6781024202', '6781024302', '6781024402', '6786014102', '6786014202', '6786014302', '6786014402', '6786014502', '6786024102', '6786024402', '6786034402', '6791014602', '6791034602', '6796014602', '6796014702', '6796024702', '6796034702', '6798014702', '6901014202', '6906014302', '6906014402', '6911014102', '6911014202', '6911014302', '6911014402', '6911024202', '6916014102', '6916014202', '6916014302', '6916014402', '6916024402', '6916024502', '6921014302', '6926014802', '6936014102', '6936024102', '6941014102', '6941014402', '6941014802', '6941024102', '6941024202', '6941024302', '6941024402', '6941024802', '6941034202', '6941034402', '6941034802', '6941044802', '6941054402', '6941054802', '6941064402', '6941074402', '6941084402', '6941094402', '6946014102', '6946014202', '6946014502', '6946014802', '6946024102', '6946034502', '6946044102', '6946054102', '6946064102', '6946074102', '6946084102', '6946094102', '6946104102', '6951014102', '6951014202', '6951014402', '6951014502', '6951024202', '6956014102', '6956024102', '6971014302', '6971014402', '6971024102', '6971024302', '6971024402', '6976014102', '6976014302', '6976014802', '6976024302', '6976034302', '6976044302', '8011014902', '8011024402', '8011024902', '8011034402', '8016014102', '8016014902', '8016024402', '8016024802', '8016024902', '8016034402', '8016034802', '8016034902', '8016044802', '8016044902', '8016054202', '8016054902', '8016064902', '8016074902', '8016084902', '8021014402', '8026014402', '8041014102', '8041014202', '8041014402', '8041014702', '8041014902', '8041024402', '8041024902', '8041034402', '8041034802', '8041034902', '8041044802', '8046014102', '8046014402', '8046014802', '8046014902', '8046024102', '8046024202', '8046024402', '8046034202', '8046034402', '8046034802', '8046054802', '8081014202', '8081014402', '8081014902', '8081024202', '8081024802', '8086014402', '8086014902', '8101014102', '8101014202', '8101014702', '8101024102', '8101024702', '8106014102', '8106014202', '8106014802', '8111014402', '8111014902', '8111024102', '8111024202', '8111024402', '8111024802', '8111024902', '8111034402', '8111034802', '8111044102', '8111044802', '8111054802', '8111064802', '8116014102', '8116014202', '8116014402', '8116014902', '8116024102', '8116024402', '8116024802', '8116034402', '8116034802', '8116044802', '8116054802', '8116064802', '8116074802', '8116084802', '8116094802', '8116104802', '8121014202', '8131014102', '8131014402', '8131014702', '8131014902', '8131024202', '8131024402', '8131024902', '8131034402', '8131034902', '8131044802', '8131044902', '8131054802', '8131054902', '8131064902', '8131074902', '8131084802', '8131094802', '8136014102', '8136014202', '8136014402', '8136014902', '8136024202', '8136024402', '8136024902', '8136034402', '8136034802', '8141014202', '8141014702', '8141024202', '8146014802', '8151014202', '8151014702', '8151014802', '8151024802', '8151034802', '8156014802', '8161014402', '8161014702', '8161014902', '8166014402', '8181014102', '8181014402', '8181014802', '8181024402', '8181034402', '8181044402', '8181054402', '8186014402', '8186024102', '8186024402', '8186034402', '8186044402', '8186054402', '8221014102', '8221014202', '8221014402', '8221014702', '8221014802', '8221014902', '8221024202', '8221024702', '8221024802', '8221034202', '8221034702', '8221044202', '8221054202', '8221064202', '8221094202', '8221104202', '8226014402', '8226014802', '8226024802', '8226044202', '8241014402', '8241024202', '8246014402', '8246024402', '0', 'V', 'S', 'E', 'M', 'R', 'P', 'C'))
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10e322190>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10e322190> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10e322190>
DEBUG:root:Gestione listino esteso: ON
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10e3220a0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 1] SELECT id_listino, tipo_prezzo, data_inizio_validita, data_fine_validita, annostag 		FROM listino_prezzi 		WHERE cod_negozio = ? 		AND data_inizio_validita != '' 		AND data_fine_validita != '' 		AND data_inizio_validita <= ? 		AND data_fine_validita >= ? (params: ('0100107', '20240719', '20240719'))
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10e3220a0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10e3220a0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10e3220a0>
DEBUG:root:Listini di prezzi abbattuti validi oggi: S (id 13444)
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10de995b0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp; 
INFO:mmfg.connection.sqlite:[conn:catalogo, 5ms, 0] CREATE TABLE catalogo_b2e_prezzi_tmp ( 									modello VARCHAR(100), 	pezzo VARCHAR(100), 									variante VARCHAR(100), 									prezzo_s decimal(13, 2), prezzo_p decimal(13, 2), prezzo_c decimal(13, 2) 								); 
INFO:mmfg.connection.sqlite:[conn:catalogo, 3ms, 0] INSERT INTO catalogo_b2e_prezzi_tmp (modello, pezzo, variante, prezzo_s, prezzo_p, prezzo_c) 					VALUES ('6011014202','0','001',149,NULL,NULL), ('6011044102','0','007',239,NULL,NULL), ('6011044102','0','008',239,NULL,NULL), ('6021014302','0','001',203,NULL,NULL), ('6021014302','0','002',203,NULL,NULL), ('6021014302','0','003',203,NULL,NULL), ('6041014302','0','009',119,NULL,NULL), ('6041014302','0','010',119,NULL,NULL), ('6041014302','0','011',119,NULL,NULL), ('6041014502','0','001',139,NULL,NULL), ('6041014502','0','005',139,NULL,NULL), ('6041024102','0','001',143,NULL,NULL), ('6041024202','0','003',161,NULL,NULL), ('6041024302','0','001',113,NULL,NULL), ('6041024302','0','003',113,NULL,NULL), ('6041024302','0','005',113,NULL,NULL), ('6041024402','0','001',131,NULL,NULL), ('6041024402','0','006',131,NULL,NULL), ('6041034202','0','001',149,NULL,NULL), ('6041034202','0','002',149,NULL,NULL), ('6041034402','0','001',119,NULL,NULL), ('6041034402','0','003',119,NULL,NULL), ('6041044102','0','001',143,NULL,NULL), ('6041044102','0','002',143,NULL,NULL), ('6041044102','0','003',143,NULL,NULL), ('6041044102','0','005',143,NULL,NULL), ('6041044202','0','001',107,NULL,NULL), ('6041044302','0','001',155,NULL,NULL), ('6041044302','0','002',155,NULL,NULL), ('6041044402','0','001',167,NULL,NULL), ('6041054102','0','003',179,NULL,NULL), ('6041054402','0','001',137,NULL,NULL), ('6041054402','0','002',137,NULL,NULL), ('6041054402','0','003',137,NULL,NULL), ('6041054402','0','004',137,NULL,NULL), ('6041064402','0','006',191,NULL,NULL), ('6041064402','0','007',191,NULL,NULL), ('6041074102','0','005',161,NULL,NULL), ('6041074102','0','007',161,NULL,NULL), ('6041074102','0','008',161,NULL,NULL), ('6041084302','0','001',155,NULL,NULL), ('6041084302','0','002',155,NULL,NULL), ('6081014102','0','002',209,NULL,NULL), ('6081024102','0','003',221,NULL,NULL), ('6081024102','0','004',221,NULL,NULL), ('6081034102','0','001',173,NULL,NULL), ('6081034102','0','002',173,NULL,NULL), ('6081044102','0','007',227,NULL,NULL), ('6081044102','0','008',227,NULL,NULL), ('6081044302','0','001',173,NULL,NULL), ('6081054102','0','001',233,NULL,NULL), ('6081054302','0','002',173,NULL,NULL), ('6081064102','0','002',197,NULL,NULL), ('6081064302','0','001',137,NULL,NULL), ('6081074302','0','002',155,NULL,NULL), ('6081074302','0','007',155,NULL,NULL), ('6101024302','0','002',77,NULL,NULL), ('6101024302','0','005',77,NULL,NULL), ('6101034402','0','001',95,NULL,NULL), ('6101034402','0','009',95,NULL,NULL), ('6101034402','0','013',95,NULL,NULL), ('6101034402','0','014',95,NULL,NULL), ('6101044302','0','001',137,NULL,NULL), ('6101044402','0','004',53,NULL,NULL), ('6101044402','0','006',53,NULL,NULL), ('6101054102','0','001',89,NULL,NULL), ('6101054102','0','004',89,NULL,NULL), ('6101054102','0','005',89,NULL,NULL), ('6101064302','0','001',111,NULL,NULL), ('6101064302','0','002',111,NULL,NULL), ('6101064302','0','003',111,NULL,NULL), ('6101074402','0','002',101,NULL,NULL), ('6101074402','0','008',101,NULL,NULL), ('6101084302','0','002',179,NULL,NULL), ('6101094302','0','007',101,NULL,NULL), ('6111014202','0','002',95,NULL,NULL), ('6111014202','0','003',95,NULL,NULL), ('6111014502','0','012',90,NULL,NULL), ('6111024102','0','001',89,NULL,NULL), ('6111024102','0','002',89,NULL,NULL), ('6111024402','0','001',83,NULL,NULL), ('6111024502','0','001',118,NULL,NULL), ('6111024502','0','003',118,NULL,NULL), ('6111034102','0','001',119,NULL,NULL), ('6111034302','0','001',111,NULL,NULL), ('6111044102','0','001',59,NULL,NULL), ('6111044102','0','003',59,NULL,NULL), ('6111044102','0','004',59,NULL,NULL), ('6111044202','0','001',83,NULL,NULL), ('6111044302','0','001',83,NULL,NULL), ('6111044402','0','001',69,NULL,NULL), ('6111044402','0','002',69,NULL,NULL), ('6111044402','0','003',69,NULL,NULL), ('6111044402','0','004',69,NULL,NULL), ('6111044402','0','005',69,NULL,NULL), ('6111054102','0','004',107,NULL,NULL), ('6111054202','0','001',131,NULL,NULL), ('6111054202','0','002',131,NULL,NULL), ('6111054202','0','003',131,NULL,NULL), ('6111054402','0','001',71,NULL,NULL), ('6111054402','0','004',71,NULL,NULL), ('6111064202','0','007',69,NULL,NULL), ('6111064202','0','008',69,NULL,NULL), ('6111064302','0','001',101,NULL,NULL), ('6111064302','0','002',101,NULL,NULL), ('6111064402','0','005',83,NULL,NULL), ('6111064402','0','008',83,NULL,NULL), ('6111064402','0','009',83,NULL,NULL), ('6111074302','0','005',77,NULL,NULL), ('6111074402','0','001',53,NULL,NULL), ('6111074402','0','002',53,NULL,NULL), ('6111074402','0','005',53,NULL,NULL), ('6111074402','0','010',53,NULL,NULL), ('6111074402','0','011',53,NULL,NULL), ('6111074402','0','012',53,NULL,NULL), ('6111084302','0','002',83,NULL,NULL), ('6111084402','0','009',83,NULL,NULL), ('6111094302','0','004',83,NULL,NULL), ('6111094302','0','007',83,NULL,NULL), ('6131014402','0','002',71,NULL,NULL), ('6131014402','0','003',71,NULL,NULL), ('6131014502','0','012',90,NULL,NULL), ('6131024102','0','001',101,NULL,NULL), ('6131024302','0','001',83,NULL,NULL), ('6131024302','0','003',83,NULL,NULL), ('6131024402','0','001',59,NULL,NULL), ('6131024402','0','002',59,NULL,NULL), ('6131024402','0','003',59,NULL,NULL), ('6131024402','0','004',59,NULL,NULL), ('6131024402','0','005',59,NULL,NULL), ('6131024502','0','001',125,NULL,NULL), ('6131024502','0','005',125,NULL,NULL), ('6131034102','0','003',83,NULL,NULL), ('6131034302','0','001',71,NULL,NULL), ('6131034302','0','002',71,NULL,NULL), ('6131034402','0','001',77,NULL,NULL), ('6131034402','0','004',77,NULL,NULL), ('6131034502','0','003',125,NULL,NULL), ('6131034502','0','005',125,NULL,NULL), ('6131044102','0','001',119,NULL,NULL), ('6131044302','0','001',89,NULL,NULL), ('6131044302','0','002',89,NULL,NULL), ('6131054102','0','001',107,NULL,NULL), ('6131054202','0','003',87,NULL,NULL), ('6131054302','0','009',149,NULL,NULL), ('6131054402','0','001',65,NULL,NULL), ('6131054402','0','004',65,NULL,NULL), ('6131054402','0','005',65,NULL,NULL), ('6131054402','0','006',65,NULL,NULL), ('6131054402','0','007',65,NULL,NULL), ('6131064102','0','001',71,NULL,NULL), ('6131064102','0','002',71,NULL,NULL), ('6131064102','0','003',71,NULL,NULL), ('6131064102','0','007',71,NULL,NULL), ('6131064202','0','001',99,NULL,NULL), ('6131064202','0','002',99,NULL,NULL), ('6131064302','0','009',77,NULL,NULL), ('6131064302','0','010',77,NULL,NULL), ('6131064302','0','011',77,NULL,NULL), ('6131064402','0','001',113,NULL,NULL), ('6131074102','0','003',71,NULL,NULL), ('6131074202','0','001',77,NULL,NULL), ('6131074202','0','003',77,NULL,NULL), ('6131074202','0','004',77,NULL,NULL), ('6131074302','0','001',107,NULL,NULL), ('6131074402','0','001',65,NULL,NULL), ('6131074402','0','002',65,NULL,NULL), ('6131074402','0','003',65,NULL,NULL), ('6131074402','0','004',65,NULL,NULL), ('6131074402','0','006',65,NULL,NULL), ('6131084102','0','001',87,NULL,NULL), ('6131084202','0','001',71,NULL,NULL), ('6131084202','0','002',71,NULL,NULL), ('6131084402','0','002',59,NULL,NULL), ('6131084402','0','014',59,NULL,NULL), ('6131084402','0','022',59,NULL,NULL), ('6131084402','0','023',59,NULL,NULL), ('6131084402','0','024',59,NULL,NULL), ('6131094102','0','001',71,NULL,NULL), ('6131094102','0','002',71,NULL,NULL), ('6131094102','0','003',71,NULL,NULL), ('6131094102','0','007',71,NULL,NULL), ('6131104102','0','005',87,NULL,NULL), ('6131104102','0','007',87,NULL,NULL), ('6131104102','0','008',87,NULL,NULL), ('6131104402','0','001',83,NULL,NULL), ('6131104402','0','003',83,NULL,NULL), ('6131114102','0','003',83,NULL,NULL), ('6131114102','0','004',83,NULL,NULL), ('6131114102','0','005',83,NULL,NULL), ('6141014402','0','001',57,NULL,NULL), ('6141014402','0','003',57,NULL,NULL), ('6141024502','0','001',90,NULL,NULL), ('6141024502','0','005',90,NULL,NULL), ('6151014102','0','005',83,NULL,NULL), ('6151024202','0','003',83,NULL,NULL), ('6161014502','0','012',48,NULL,NULL), ('6161024302','0','001',75,NULL,NULL), ('6161034102','0','003',59,NULL,NULL), ('6161034102','0','004',59,NULL,NULL), ('6181014102','0','001',89,NULL,NULL), ('6181024102','0','001',99,NULL,NULL), ('6181034302','0','001',95,NULL,NULL), ('6181044202','0','001',83,NULL,NULL), ('6181044302','0','001',107,NULL,NULL), ('6181054202','0','001',77,NULL,NULL), ('6181054302','0','001',95,NULL,NULL), ('6181064302','0','001',107,NULL,NULL), ('6191014502','0','001',104,NULL,NULL), ('6191024302','0','009',155,NULL,NULL), ('6221014402','0','001',293,NULL,NULL), ('6221014502','0','001',132,NULL,NULL), ('6221014502','0','004',132,NULL,NULL), ('6221024202','0','002',137,NULL,NULL), ('6221024202','0','003',137,NULL,NULL), ('6221024302','0','005',119,NULL,NULL), ('6221034202','0','001',119,NULL,NULL), ('6221034202','0','003',119,NULL,NULL), ('6221034202','0','004',119,NULL,NULL), ('6221044302','0','014',131,NULL,NULL), ('6221044302','0','015',131,NULL,NULL), ('6221044302','0','024',131,NULL,NULL), ('6221044402','0','006',215,NULL,NULL), ('6221044402','0','007',215,NULL,NULL), ('6221054502','0','001',111,NULL,NULL), ('6221064402','0','014',107,NULL,NULL), ('6221074402','0','002',155,NULL,NULL), ('6221074402','0','013',155,NULL,NULL), ('6221084102','0','003',119,NULL,NULL), ('6221084102','0','004',119,NULL,NULL), ('6221084402','0','002',119,NULL,NULL), ('6221084402','0','009',119,NULL,NULL), ('6221094302','0','008',101,NULL,NULL), ('6221094302','0','009',101,NULL,NULL), ('6221094302','0','011',101,NULL,NULL), ('6221094402','0','002',107,NULL,NULL), ('6221094402','0','014',107,NULL,NULL), ('6221104402','0','006',83,NULL,NULL), ('6221114102','0','002',119,NULL,NULL), ('6221114102','0','003',119,NULL,NULL), ('6221124102','0','001',137,NULL,NULL), ('6221144102','0','001',137,NULL,NULL), ('6221154102','0','001',149,NULL,NULL), ('6221154402','0','002',113,NULL,NULL), ('6221154402','0','007',113,NULL,NULL), ('6221154402','0','009',113,NULL,NULL), ('6221154402','0','018',113,NULL,NULL), ('6221154402','0','020',113,NULL,NULL), ('6221154402','0','021',113,NULL,NULL), ('6221164102','0','004',83,NULL,NULL), ('6221164402','0','001',95,NULL,NULL), ('6221164402','0','013',95,NULL,NULL), ('6221164402','0','014',95,NULL,NULL), ('6221174402','0','011',117,NULL,NULL), ('6221174402','0','022',117,NULL,NULL), ('6241014302','0','009',113,NULL,NULL), ('6241014302','0','010',113,NULL,NULL), ('6241024102','0','001',113,NULL,NULL), ('6241024102','0','004',113,NULL,NULL), ('6241024402','0','001',119,NULL,NULL), ('6241024402','0','002',119,NULL,NULL), ('6241034402','0','003',209,NULL,NULL), ('6291014602','0','001',71,NULL,NULL), ('6291014602','0','004',71,NULL,NULL), ('6291014602','0','005',71,NULL,NULL), ('6321014302','0','004',113,NULL,NULL), ('6321014402','0','001',119,NULL,NULL), ('6331014102','0','002',101,NULL,NULL), ('6331024102','0','001',101,NULL,NULL), ('6341014102','0','001',83,NULL,NULL), ('6341014102','0','002',83,NULL,NULL), ('6341014102','0','004',83,NULL,NULL), ('6341014302','0','001',107,NULL,NULL), ('6341014402','0','001',101,NULL,NULL), ('6341014402','0','003',101,NULL,NULL), ('6341024102','0','003',101,NULL,NULL), ('6341034102','0','001',113,NULL,NULL), ('6341044102','0','001',113,NULL,NULL), ('6361014102','0','002',95,NULL,NULL), ('6361014102','0','003',95,NULL,NULL), ('6361014202','0','001',83,NULL,NULL), ('6361014202','0','002',83,NULL,NULL), ('6361014302','0','001',89,NULL,NULL), ('6361014402','0','001',89,NULL,NULL), ('6361014402','0','003',89,NULL,NULL), ('6361024102','0','002',83,NULL,NULL), ('6361024102','0','003',83,NULL,NULL), ('6361024302','0','001',113,NULL,NULL), ('6361024402','0','001',47,NULL,NULL), ('6361024402','0','002',47,NULL,NULL), ('6361034102','0','003',71,NULL,NULL), ('6361034202','0','001',95,NULL,NULL), ('6361034202','0','002',95,NULL,NULL), ('6361034302','0','001',71,NULL,NULL), ('6361034302','0','002',71,NULL,NULL), ('6361044102','0','001',95,NULL,NULL), ('6361044102','0','002',95,NULL,NULL), ('6361044202','0','001',113,NULL,NULL), ('6361044202','0','002',113,NULL,NULL), ('6361054102','0','002',77,NULL,NULL), ('6361054102','0','003',77,NULL,NULL), ('6361054302','0','001',71,NULL,NULL), ('6361054302','0','002',71,NULL,NULL), ('6361054302','0','003',71,NULL,NULL), ('6361054302','0','004',71,NULL,NULL), ('6361064302','0','001',101,NULL,NULL), ('6361064302','0','002',101,NULL,NULL), ('6361074102','0','001',173,NULL,NULL), ('6361074102','0','002',173,NULL,NULL), ('6361074102','0','003',173,NULL,NULL), ('6361074302','0','001',89,NULL,NULL), ('6361084102','0','004',131,NULL,NULL), ('6361084102','0','005',131,NULL,NULL), ('6361084202','0','001',113,NULL,NULL), ('6361104102','0','001',95,NULL,NULL), ('6361104102','0','004',95,NULL,NULL), ('6361114102','0','001',101,NULL,NULL), ('6371014402','0','001',83,NULL,NULL), ('6371014402','0','002',83,NULL,NULL), ('6381014102','0','008',119,NULL,NULL), ('6381014102','0','009',119,NULL,NULL), ('6381014102','0','012',119,NULL,NULL), ('6441014102','0','001',269,NULL,NULL), ('6441034202','0','001',239,NULL,NULL), ('6481014202','0','004',173,NULL,NULL), ('6481014202','0','007',173,NULL,NULL), ('6491014202','0','004',179,NULL,NULL), ('6491014202','0','007',179,NULL,NULL), ('6501014602','0','001',47,NULL,NULL), ('6501014602','0','002',47,NULL,NULL), ('6501014702','0','001',59,NULL,NULL), ('6501024602','0','001',41,NULL,NULL), ('6501024602','0','002',41,NULL,NULL), ('6501024602','0','003',41,NULL,NULL), ('6501034702','0','001',35,NULL,NULL), ('6501034702','0','002',35,NULL,NULL), ('6501034702','0','003',35,NULL,NULL), ('6501044702','0','001',47,NULL,NULL), ('6501054702','0','001',45,NULL,NULL), ('6501064702','0','001',53,NULL,NULL), ('6511014602','0','001',89,NULL,NULL), ('6511014602','0','002',89,NULL,NULL), ('6511014602','0','003',89,NULL,NULL), ('6511014702','0','001',71,NULL,NULL), ('6511024702','0','002',83,NULL,NULL), ('6511024702','0','003',83,NULL,NULL), ('6511034602','0','001',113,NULL,NULL), ('6511034702','0','004',149,NULL,NULL), ('6511034702','0','005',149,NULL,NULL), ('6511034702','0','006',149,NULL,NULL), ('6511044602','0','001',95,NULL,NULL), ('6511044702','0','001',113,NULL,NULL), ('6511054602','0','001',83,NULL,NULL), ('6511054602','0','002',83,NULL,NULL), ('6511054602','0','003',83,NULL,NULL), ('6511054702','0','001',59,NULL,NULL), ('6511064602','0','001',59,NULL,NULL), ('6511064602','0','002',59,NULL,NULL), ('6511064702','0','001',59,NULL,NULL), ('6511064702','0','002',59,NULL,NULL), ('6511064702','0','003',59,NULL,NULL), ('6521014602','0','001',101,NULL,NULL), ('6521014602','0','002',101,NULL,NULL), ('6521014602','0','003',101,NULL,NULL), ('6521014702','0','001',107,NULL,NULL), ('6521014702','0','002',107,NULL,NULL), ('6521014702','0','003',107,NULL,NULL), ('6521024602','0','002',101,NULL,NULL), ('6521034602','0','001',137,NULL,NULL), ('6521044702','0','001',137,NULL,NULL), ('6521044702','0','002',137,NULL,NULL), ('6521054702','0','001',155,NULL,NULL), ('6521054702','0','002',155,NULL,NULL), ('6521054702','0','003',155,NULL,NULL), ('6521054702','0','004',155,NULL,NULL), ('6521054702','0','005',155,NULL,NULL), ('6521064702','0','001',119,NULL,NULL), ('6521084702','0','001',119,NULL,NULL), ('6521094702','0','001',119,NULL,NULL), ('6521094702','0','002',119,NULL,NULL), ('6541014702','0','001',45,NULL,NULL), ('6541014702','0','002',45,NULL,NULL), ('6541024602','0','001',59,NULL,NULL), ('6541024602','0','002',59,NULL,NULL), ('6541024602','0','003',59,NULL,NULL), ('6541024702','0','001',53,NULL,NULL), ('6541024702','0','002',53,NULL,NULL), ('6541024702','0','003',53,NULL,NULL), ('6541034602','0','001',41,NULL,NULL), ('6541034602','0','002',41,NULL,NULL), ('6541034602','0','003',41,NULL,NULL), ('6541034702','0','001',47,NULL,NULL), ('6541034702','0','002',47,NULL,NULL), ('6541034702','0','003',47,NULL,NULL), ('6541034702','0','004',47,NULL,NULL), ('6541044702','0','001',35,NULL,NULL), ('6541044702','0','002',35,NULL,NULL), ('6571014602','0','001',35,NULL,NULL), ('6571014602','0','002',35,NULL,NULL), ('6571014702','0','001',35,NULL,NULL), ('6571014702','0','002',35,NULL,NULL), ('6571024702','0','001',47,NULL,NULL), ('6571034602','0','001',47,NULL,NULL), ('6571034602','0','002',47,NULL,NULL), ('6571034602','0','003',47,NULL,NULL), ('6611014602','0','001',59,NULL,NULL), ('6611014602','0','002',59,NULL,NULL), ('6611014602','0','003',59,NULL,NULL), ('6621014102','0','001',113,NULL,NULL), ('6621014202','0','001',89,NULL,NULL), ('6621014302','0','001',101,NULL,NULL), ('6621014302','0','002',101,NULL,NULL), ('6621014302','0','004',101,NULL,NULL), ('6621014502','0','001',139,NULL,NULL), ('6621014502','0','002',139,NULL,NULL), ('6621014802','0','001',107,NULL,NULL), ('6621024102','0','001',119,NULL,NULL), ('6621024402','0','001',83,NULL,NULL), ('6621024402','0','002',83,NULL,NULL), ('6621034302','0','001',131,NULL,NULL), ('6621034302','0','002',131,NULL,NULL), ('6621034402','0','001',101,NULL,NULL), ('6621034402','0','003',101,NULL,NULL), ('6621044102','0','005',101,NULL,NULL), ('6621044402','0','001',119,NULL,NULL), ('6621044402','0','002',119,NULL,NULL), ('6621044402','0','003',119,NULL,NULL), ('6621054402','0','001',101,NULL,NULL), ('6621064402','0','001',113,NULL,NULL), ('6621064402','0','002',113,NULL,NULL), ('6621074102','0','002',113,NULL,NULL), ('6621074402','0','001',113,NULL,NULL), ('6621074402','0','002',113,NULL,NULL), ('6621084102','0','001',107,NULL,NULL), ('6621084102','0','003',107,NULL,NULL), ('6631014402','0','001',113,NULL,NULL), ('6631014402','0','002',113,NULL,NULL), ('6631024102','0','001',137,NULL,NULL), ('6641014102','0','001',131,NULL,NULL), ('6641014402','0','001',107,NULL,NULL), ('6641014402','0','002',107,NULL,NULL), ('6751014702','0','001',41,NULL,NULL), ('6751014802','0','001',51,NULL,NULL), ('6751024602','0','001',41,NULL,NULL), ('6751024802','0','001',59,NULL,NULL), ('6751034602','0','001',41,NULL,NULL), ('6751034602','0','002',41,NULL,NULL), ('6751034802','0','001',71,NULL,NULL), ('6751044802','0','001',77,NULL,NULL), ('6761014602','0','001',101,NULL,NULL), ('6761014602','0','002',101,NULL,NULL), ('6761014602','0','003',101,NULL,NULL), ('6771014102','0','001',65,NULL,NULL), ('6771014102','0','002',65,NULL,NULL), ('6771014302','0','001',95,NULL,NULL), ('6771014302','0','002',95,NULL,NULL), ('6771014402','0','001',101,NULL,NULL), ('6771014402','0','002',101,NULL,NULL), ('6771014402','0','003',101,NULL,NULL), ('6771024302','0','001',113,NULL,NULL), ('6771024302','0','002',113,NULL,NULL), ('6771024402','0','001',77,NULL,NULL), ('6771024402','0','002',77,NULL,NULL), ('6771034302','0','001',83,NULL,NULL), ('6771034302','0','002',83,NULL,NULL), ('6781014102','0','001',95,NULL,NULL), ('6781014202','0','001',95,NULL,NULL), ('6781014202','0','002',95,NULL,NULL), ('6781014302','0','001',89,NULL,NULL), ('6781014302','0','002',89,NULL,NULL), ('6781014402','0','001',83,NULL,NULL), ('6781024202','0','001',89,NULL,NULL), ('6781024202','0','002',89,NULL,NULL), ('6781024302','0','001',101,NULL,NULL), ('6781024302','0','003',101,NULL,NULL), ('6781024302','0','004',101,NULL,NULL), ('6781024402','0','002',83,NULL,NULL), ('6781024402','0','003',83,NULL,NULL), ('6791014602','0','001',215,NULL,NULL), ('6791034602','0','001',173,NULL,NULL), ('6901014202','0','001',119,NULL,NULL), ('6901014202','0','002',119,NULL,NULL), ('6911014102','0','001',107,NULL,NULL), ('6911014102','0','002',107,NULL,NULL), ('6911014202','0','001',107,NULL,NULL), ('6911014202','0','002',107,NULL,NULL), ('6911014202','0','003',107,NULL,NULL), ('6911014302','0','001',131,NULL,NULL), ('6911014302','0','002',131,NULL,NULL), ('6911014402','0','001',107,NULL,NULL), ('6911024202','0','001',89,NULL,NULL), ('6911024202','0','002',89,NULL,NULL), ('6921014302','0','001',95,NULL,NULL), ('6921014302','0','002',95,NULL,NULL), ('6941014102','0','002',47,NULL,NULL), ('6941014102','0','003',47,NULL,NULL), ('6941014102','0','004',47,NULL,NULL), ('6941014402','0','001',33,NULL,NULL), ('6941014402','0','002',33,NULL,NULL), ('6941014402','0','003',33,NULL,NULL), ('6941014402','0','004',33,NULL,NULL), ('6941014802','0','001',59,NULL,NULL), ('6941014802','0','002',59,NULL,NULL), ('6941014802','0','003',59,NULL,NULL), ('6941014802','0','004',59,NULL,NULL), ('6941024102','0','001',53,NULL,NULL), ('6941024102','0','002',53,NULL,NULL), ('6941024102','0','003',53,NULL,NULL), ('6941024202','0','001',65,NULL,NULL), ('6941024202','0','002',65,NULL,NULL), ('6941024202','0','003',65,NULL,NULL), ('6941024302','0','001',51,NULL,NULL), ('6941024302','0','002',51,NULL,NULL), ('6941024302','0','003',51,NULL,NULL), ('6941024402','0','001',29,NULL,NULL), ('6941024402','0','002',29,NULL,NULL), ('6941024402','0','003',29,NULL,NULL), ('6941024402','0','004',29,NULL,NULL), ('6941024802','0','005',53,NULL,NULL), ('6941034202','0','004',53,NULL,NULL), ('6941034402','0','001',59,NULL,NULL), ('6941034402','0','002',59,NULL,NULL), ('6941034802','0','001',53,NULL,NULL), ('6941044802','0','001',47,NULL,NULL), ('6941054402','0','001',47,NULL,NULL), ('6941054402','0','002',47,NULL,NULL), ('6941054402','0','003',47,NULL,NULL), ('6941054802','0','002',53,NULL,NULL), ('6941054802','0','003',53,NULL,NULL), ('6941054802','0','004',53,NULL,NULL), ('6941064402','0','001',65,NULL,NULL), ('6941064402','0','004',65,NULL,NULL), ('6941074402','0','005',41,NULL,NULL), ('6941084402','0','001',59,NULL,NULL), ('6941094402','0','002',41,NULL,NULL), ('6941094402','0','003',41,NULL,NULL), ('6941094402','0','004',41,NULL,NULL), ('6951014102','0','001',83,NULL,NULL), ('6951014202','0','001',75,NULL,NULL), ('6951014202','0','002',75,NULL,NULL), ('6951014402','0','001',77,NULL,NULL), ('6951014402','0','003',77,NULL,NULL), ('6951014502','0','001',69,NULL,NULL), ('6951014502','0','002',69,NULL,NULL), ('6951024202','0','001',59,NULL,NULL), ('6971014302','0','001',65,NULL,NULL), ('6971014302','0','002',65,NULL,NULL), ('6971014302','0','003',65,NULL,NULL), ('6971014302','0','004',65,NULL,NULL), ('6971014402','0','006',47,NULL,NULL), ('6971024102','0','001',53,NULL,NULL), ('6971024302','0','001',35,NULL,NULL), ('6971024302','0','002',35,NULL,NULL), ('6971024302','0','003',35,NULL,NULL), ('6971024402','0','001',59,NULL,NULL), ('6971024402','0','002',59,NULL,NULL), ('6971024402','0','003',59,NULL,NULL), ('6971024402','0','004',59,NULL,NULL), ('8041014102','0','001',137,NULL,NULL), ('8041014202','0','001',227,NULL,NULL), ('8041014702','0','002',161,NULL,NULL), ('8041034802','0','001',149,NULL,NULL), ('8041034902','0','005',137,NULL,NULL), ('8041044802','0','001',209,NULL,NULL), ('8041044802','0','002',209,NULL,NULL), ('8041044802','0','003',209,NULL,NULL), ('8081014202','0','001',239,NULL,NULL), ('8081024202','0','002',299,NULL,NULL), ('8101014102','0','001',107,NULL,NULL), ('8101014202','0','010',129,NULL,NULL), ('8101014702','0','001',71,NULL,NULL), ('8101014702','0','002',71,NULL,NULL), ('8101024102','0','001',77,NULL,NULL), ('8101024102','0','002',77,NULL,NULL), ('8101024702','0','001',77,NULL,NULL), ('8101024702','0','002',77,NULL,NULL), ('8111024102','0','001',83,NULL,NULL), ('8111024102','0','002',83,NULL,NULL), ('8111024202','0','001',113,NULL,NULL), ('8111024802','0','016',71,NULL,NULL), ('8111024802','0','017',71,NULL,NULL), ('8111024802','0','018',71,NULL,NULL), ('8111034802','0','013',83,NULL,NULL), ('8111034802','0','023',83,NULL,NULL), ('8111044102','0','001',83,NULL,NULL), ('8111044802','0','014',90,NULL,NULL), ('8111044802','0','023',90,NULL,NULL), ('8111054802','0','001',111,NULL,NULL), ('8111054802','0','007',111,NULL,NULL), ('8111054802','0','008',111,NULL,NULL), ('8111064802','0','001',118,NULL,NULL), ('8111064802','0','007',118,NULL,NULL), ('8111064802','0','009',118,NULL,NULL), ('8121014202','0','002',239,NULL,NULL), ('8131014102','0','002',107,NULL,NULL), ('8131014702','0','001',101,NULL,NULL), ('8131014702','0','002',101,NULL,NULL), ('8131014902','0','001',65,NULL,NULL), ('8131024202','0','002',113,NULL,NULL), ('8131044802','0','016',83,NULL,NULL), ('8131044802','0','017',83,NULL,NULL), ('8131044802','0','018',83,NULL,NULL), ('8131054802','0','001',125,NULL,NULL), ('8131054802','0','008',125,NULL,NULL), ('8131054802','0','009',125,NULL,NULL), ('8131064902','0','004',125,NULL,NULL), ('8131074902','0','005',65,NULL,NULL), ('8131084802','0','001',118,NULL,NULL), ('8131084802','0','002',118,NULL,NULL), ('8131084802','0','003',118,NULL,NULL), ('8131094802','0','001',125,NULL,NULL), ('8131094802','0','002',125,NULL,NULL), ('8131094802','0','003',125,NULL,NULL), ('8141014202','0','001',83,NULL,NULL), ('8141014702','0','002',71,NULL,NULL), ('8141024202','0','001',83,NULL,NULL), ('8151014202','0','001',179,NULL,NULL), ('8151014702','0','001',131,NULL,NULL), ('8151014702','0','002',131,NULL,NULL), ('8151014802','0','001',119,NULL,NULL), ('8151014802','0','002',119,NULL,NULL), ('8151014802','0','005',119,NULL,NULL), ('8151024802','0','001',77,NULL,NULL), ('8151034802','0','001',111,NULL,NULL), ('8151034802','0','008',111,NULL,NULL), ('8151034802','0','009',111,NULL,NULL), ('8161014702','0','001',41,NULL,NULL), ('8161014702','0','002',41,NULL,NULL), ('8181014102','0','001',119,NULL,NULL), ('8181014802','0','001',107,NULL,NULL), ('8221014102','0','002',101,NULL,NULL), ('8221014202','0','002',113,NULL,NULL), ('8221014702','0','001',89,NULL,NULL), ('8221014802','0','001',119,NULL,NULL), ('8221014802','0','002',119,NULL,NULL), ('8221014802','0','003',119,NULL,NULL), ('8221014902','0','005',113,NULL,NULL), ('8221014902','0','022',113,NULL,NULL), ('8221024202','0','009',197,NULL,NULL), ('8221024802','0','001',167,NULL,NULL), ('8221024802','0','006',167,NULL,NULL), ('8221024802','0','008',167,NULL,NULL), ('8221034202','0','002',191,NULL,NULL), ('8221044202','0','003',173,NULL,NULL), ('8221044202','0','005',173,NULL,NULL), ('8221054202','0','006',257,NULL,NULL), ('8221064202','0','007',221,NULL,NULL), ('8221094202','0','005',107,NULL,NULL), ('8221104202','0','011',215,NULL,NULL), ('8241024202','0','001',149,NULL,NULL) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 2ms, 0] REPLACE INTO catalogo_b2e_varianti_prezzi 								SELECT prz.modello as modello_principale, var.variante, '0100107' as cod_negozio, prz.prezzo_s, prz.prezzo_p, prz.prezzo_c 								FROM catalogo_b2e_prezzi_tmp przLEFT JOIN catalogo_b2e_varianti AS var ON var.modello = prz.modello AND var.pezzo = prz.pezzo 								WHERE (prz.variante = 'all' OR prz.variante = var.variante); 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp; 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10de995b0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10de995b0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp;"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE catalogo_b2e_prezzi_tmp (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tmodello VARCHAR(100),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tpezzo VARCHAR(100),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvariante VARCHAR(100),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tprezzo_s decimal(13, 2),\\nprezzo_p decimal(13, 2),\\nprezzo_c decimal(13, 2)\\n\\t\\t\\t\\t\\t\\t\\t\\t);"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO catalogo_b2e_prezzi_tmp (modello, pezzo, variante, prezzo_s, prezzo_p, prezzo_c)\\n\\t\\t\\t\\t\\t\\t\\t\\tVALUES (\'6011014202\',\'0\',\'001\',149,NULL,NULL), (\'6011044102\',\'0\',\'007\',239,NULL,NULL), (\'6011044102\',\'0\',\'008\',239,NULL,NULL), (\'6021014302\',\'0\',\'001\',203,NULL,NULL), (\'6021014302\',\'0\',\'002\',203,NULL,NULL), (\'6021014302\',\'0\',\'003\',203,NULL,NULL), (\'6041014302\',\'0\',\'009\',119,NULL,NULL), (\'6041014302\',\'0\',\'010\',119,NULL,NULL), (\'6041014302\',\'0\',\'011\',119,NULL,NULL), (\'6041014502\',\'0\',\'001\',139,NULL,NULL), (\'6041014502\',\'0\',\'005\',139,NULL,NULL), (\'6041024102\',\'0\',\'001\',143,NULL,NULL), (\'6041024202\',\'0\',\'003\',161,NULL,NULL), (\'6041024302\',\'0\',\'001\',113,NULL,NULL), (\'6041024302\',\'0\',\'003\',113,NULL,NULL), (\'6041024302\',\'0\',\'005\',113,NULL,NULL), (\'6041024402\',\'0\',\'001\',131,NULL,NULL), (\'6041024402\',\'0\',\'006\',131,NULL,NULL), (\'6041034202\',\'0\',\'001\',149,NULL,NULL), (\'6041034202\',\'0\',\'002\',149,NULL,NULL), (\'6041034402\',\'0\',\'001\',119,NULL,NULL), (\'6041034402\',\'0\',\'003\',119,NULL,NULL), (\'6041044102\',\'0\',\'001\',143,NULL,NULL), (\'6041044102\',\'0\',\'002\',143,NULL,NULL), (\'6041044102\',\'0\',\'003\',143,NULL,NULL), (\'6041044102\',\'0\',\'005\',143,NULL,NULL), (\'6041044202\',\'0\',\'001\',107,NULL,NULL), (\'6041044302\',\'0\',\'001\',155,NULL,NULL), (\'6041044302\',\'0\',\'002\',155,NULL,NULL), (\'6041044402\',\'0\',\'001\',167,NULL,NULL), (\'6041054102\',\'0\',\'003\',179,NULL,NULL), (\'6041054402\',\'0\',\'001\',137,NULL,NULL), (\'6041054402\',\'0\',\'002\',137,NULL,NULL), (\'6041054402\',\'0\',\'003\',137,NULL,NULL), (\'6041054402\',\'0\',\'004\',137,NULL,NULL), (\'6041064402\',\'0\',\'006\',191,NULL,NULL), (\'6041064402\',\'0\',\'007\',191,NULL,NULL), (\'6041074102\',\'0\',\'005\',161,NULL,NULL), (\'6041074102\',\'0\',\'007\',161,NULL,NULL), (\'6041074102\',\'0\',\'008\',161,NULL,NULL), (\'6041084302\',\'0\',\'001\',155,NULL,NULL), (\'6041084302\',\'0\',\'002\',155,NULL,NULL), (\'6081014102\',\'0\',\'002\',209,NULL,NULL), (\'6081024102\',\'0\',\'003\',221,NULL,NULL), (\'6081024102\',\'0\',\'004\',221,NULL,NULL), (\'6081034102\',\'0\',\'001\',173,NULL,NULL), (\'6081034102\',\'0\',\'002\',173,NULL,NULL), (\'6081044102\',\'0\',\'007\',227,NULL,NULL), (\'6081044102\',\'0\',\'008\',227,NULL,NULL), (\'6081044302\',\'0\',\'001\',173,NULL,NULL), (\'6081054102\',\'0\',\'001\',233,NULL,NULL), (\'6081054302\',\'0\',\'002\',173,NULL,NULL), (\'6081064102\',\'0\',\'002\',197,NULL,NULL), (\'6081064302\',\'0\',\'001\',137,NULL,NULL), (\'6081074302\',\'0\',\'002\',155,NULL,NULL), (\'6081074302\',\'0\',\'007\',155,NULL,NULL), (\'6101024302\',\'0\',\'002\',77,NULL,NULL), (\'6101024302\',\'0\',\'005\',77,NULL,NULL), (\'6101034402\',\'0\',\'001\',95,NULL,NULL), (\'6101034402\',\'0\',\'009\',95,NULL,NULL), (\'6101034402\',\'0\',\'013\',95,NULL,NULL), (\'6101034402\',\'0\',\'014\',95,NULL,NULL), (\'6101044302\',\'0\',\'001\',137,NULL,NULL), (\'6101044402\',\'0\',\'004\',53,NULL,NULL), (\'6101044402\',\'0\',\'006\',53,NULL,NULL), (\'6101054102\',\'0\',\'001\',89,NULL,NULL), (\'6101054102\',\'0\',\'004\',89,NULL,NULL), (\'6101054102\',\'0\',\'005\',89,NULL,NULL), (\'6101064302\',\'0\',\'001\',111,NULL,NULL), (\'6101064302\',\'0\',\'002\',111,NULL,NULL), (\'6101064302\',\'0\',\'003\',111,NULL,NULL), (\'6101074402\',\'0\',\'002\',101,NULL,NULL), (\'6101074402\',\'0\',\'008\',101,NULL,NULL), (\'6101084302\',\'0\',\'002\',179,NULL,NULL), (\'6101094302\',\'0\',\'007\',101,NULL,NULL), (\'6111014202\',\'0\',\'002\',95,NULL,NULL), (\'6111014202\',\'0\',\'003\',95,NULL,NULL), (\'6111014502\',\'0\',\'012\',90,NULL,NULL), (\'6111024102\',\'0\',\'001\',89,NULL,NULL), (\'6111024102\',\'0\',\'002\',89,NULL,NULL), (\'6111024402\',\'0\',\'001\',83,NULL,NULL), (\'6111024502\',\'0\',\'001\',118,NULL,NULL), (\'6111024502\',\'0\',\'003\',118,NULL,NULL), (\'6111034102\',\'0\',\'001\',119,NULL,NULL), (\'6111034302\',\'0\',\'001\',111,NULL,NULL), (\'6111044102\',\'0\',\'001\',59,NULL,NULL), (\'6111044102\',\'0\',\'003\',59,NULL,NULL), (\'6111044102\',\'0\',\'004\',59,NULL,NULL), (\'6111044202\',\'0\',\'001\',83,NULL,NULL), (\'6111044302\',\'0\',\'001\',83,NULL,NULL), (\'6111044402\',\'0\',\'001\',69,NULL,NULL), (\'6111044402\',\'0\',\'002\',69,NULL,NULL), (\'6111044402\',\'0\',\'003\',69,NULL,NULL), (\'6111044402\',\'0\',\'004\',69,NULL,NULL), (\'6111044402\',\'0\',\'005\',69,NULL,NULL), (\'6111054102\',\'0\',\'004\',107,NULL,NULL), (\'6111054202\',\'0\',\'001\',131,NULL,NULL), (\'6111054202\',\'0\',\'002\',131,NULL,NULL), (\'6111054202\',\'0\',\'003\',131,NULL,NULL), (\'6111054402\',\'0\',\'001\',71,NULL,NULL), (\'6111054402\',\'0\',\'004\',71,NULL,NULL), (\'6111064202\',\'0\',\'007\',69,NULL,NULL), (\'6111064202\',\'0\',\'008\',69,NULL,NULL), (\'6111064302\',\'0\',\'001\',101,NULL,NULL), (\'6111064302\',\'0\',\'002\',101,NULL,NULL), (\'6111064402\',\'0\',\'005\',83,NULL,NULL), (\'6111064402\',\'0\',\'008\',83,NULL,NULL), (\'6111064402\',\'0\',\'009\',83,NULL,NULL), (\'6111074302\',\'0\',\'005\',77,NULL,NULL), (\'6111074402\',\'0\',\'001\',53,NULL,NULL), (\'6111074402\',\'0\',\'002\',53,NULL,NULL), (\'6111074402\',\'0\',\'005\',53,NULL,NULL), (\'6111074402\',\'0\',\'010\',53,NULL,NULL), (\'6111074402\',\'0\',\'011\',53,NULL,NULL), (\'6111074402\',\'0\',\'012\',53,NULL,NULL), (\'6111084302\',\'0\',\'002\',83,NULL,NULL), (\'6111084402\',\'0\',\'009\',83,NULL,NULL), (\'6111094302\',\'0\',\'004\',83,NULL,NULL), (\'6111094302\',\'0\',\'007\',83,NULL,NULL), (\'6131014402\',\'0\',\'002\',71,NULL,NULL), (\'6131014402\',\'0\',\'003\',71,NULL,NULL), (\'6131014502\',\'0\',\'012\',90,NULL,NULL), (\'6131024102\',\'0\',\'001\',101,NULL,NULL), (\'6131024302\',\'0\',\'001\',83,NULL,NULL), (\'6131024302\',\'0\',\'003\',83,NULL,NULL), (\'6131024402\',\'0\',\'001\',59,NULL,NULL), (\'6131024402\',\'0\',\'002\',59,NULL,NULL), (\'6131024402\',\'0\',\'003\',59,NULL,NULL), (\'6131024402\',\'0\',\'004\',59,NULL,NULL), (\'6131024402\',\'0\',\'005\',59,NULL,NULL), (\'6131024502\',\'0\',\'001\',125,NULL,NULL), (\'6131024502\',\'0\',\'005\',125,NULL,NULL), (\'6131034102\',\'0\',\'003\',83,NULL,NULL), (\'6131034302\',\'0\',\'001\',71,NULL,NULL), (\'6131034302\',\'0\',\'002\',71,NULL,NULL), (\'6131034402\',\'0\',\'001\',77,NULL,NULL), (\'6131034402\',\'0\',\'004\',77,NULL,NULL), (\'6131034502\',\'0\',\'003\',125,NULL,NULL), (\'6131034502\',\'0\',\'005\',125,NULL,NULL), (\'6131044102\',\'0\',\'001\',119,NULL,NULL), (\'6131044302\',\'0\',\'001\',89,NULL,NULL), (\'6131044302\',\'0\',\'002\',89,NULL,NULL), (\'6131054102\',\'0\',\'001\',107,NULL,NULL), (\'6131054202\',\'0\',\'003\',87,NULL,NULL), (\'6131054302\',\'0\',\'009\',149,NULL,NULL), (\'6131054402\',\'0\',\'001\',65,NULL,NULL), (\'6131054402\',\'0\',\'004\',65,NULL,NULL), (\'6131054402\',\'0\',\'005\',65,NULL,NULL), (\'6131054402\',\'0\',\'006\',65,NULL,NULL), (\'6131054402\',\'0\',\'007\',65,NULL,NULL), (\'6131064102\',\'0\',\'001\',71,NULL,NULL), (\'6131064102\',\'0\',\'002\',71,NULL,NULL), (\'6131064102\',\'0\',\'003\',71,NULL,NULL), (\'6131064102\',\'0\',\'007\',71,NULL,NULL), (\'6131064202\',\'0\',\'001\',99,NULL,NULL), (\'6131064202\',\'0\',\'002\',99,NULL,NULL), (\'6131064302\',\'0\',\'009\',77,NULL,NULL), (\'6131064302\',\'0\',\'010\',77,NULL,NULL), (\'6131064302\',\'0\',\'011\',77,NULL,NULL), (\'6131064402\',\'0\',\'001\',113,NULL,NULL), (\'6131074102\',\'0\',\'003\',71,NULL,NULL), (\'6131074202\',\'0\',\'001\',77,NULL,NULL), (\'6131074202\',\'0\',\'003\',77,NULL,NULL), (\'6131074202\',\'0\',\'004\',77,NULL,NULL), (\'6131074302\',\'0\',\'001\',107,NULL,NULL), (\'6131074402\',\'0\',\'001\',65,NULL,NULL), (\'6131074402\',\'0\',\'002\',65,NULL,NULL), (\'6131074402\',\'0\',\'003\',65,NULL,NULL), (\'6131074402\',\'0\',\'004\',65,NULL,NULL), (\'6131074402\',\'0\',\'006\',65,NULL,NULL), (\'6131084102\',\'0\',\'001\',87,NULL,NULL), (\'6131084202\',\'0\',\'001\',71,NULL,NULL), (\'6131084202\',\'0\',\'002\',71,NULL,NULL), (\'6131084402\',\'0\',\'002\',59,NULL,NULL), (\'6131084402\',\'0\',\'014\',59,NULL,NULL), (\'6131084402\',\'0\',\'022\',59,NULL,NULL), (\'6131084402\',\'0\',\'023\',59,NULL,NULL), (\'6131084402\',\'0\',\'024\',59,NULL,NULL), (\'6131094102\',\'0\',\'001\',71,NULL,NULL), (\'6131094102\',\'0\',\'002\',71,NULL,NULL), (\'6131094102\',\'0\',\'003\',71,NULL,NULL), (\'6131094102\',\'0\',\'007\',71,NULL,NULL), (\'6131104102\',\'0\',\'005\',87,NULL,NULL), (\'6131104102\',\'0\',\'007\',87,NULL,NULL), (\'6131104102\',\'0\',\'008\',87,NULL,NULL), (\'6131104402\',\'0\',\'001\',83,NULL,NULL), (\'6131104402\',\'0\',\'003\',83,NULL,NULL), (\'6131114102\',\'0\',\'003\',83,NULL,NULL), (\'6131114102\',\'0\',\'004\',83,NULL,NULL), (\'6131114102\',\'0\',\'005\',83,NULL,NULL), (\'6141014402\',\'0\',\'001\',57,NULL,NULL), (\'6141014402\',\'0\',\'003\',57,NULL,NULL), (\'6141024502\',\'0\',\'001\',90,NULL,NULL), (\'6141024502\',\'0\',\'005\',90,NULL,NULL), (\'6151014102\',\'0\',\'005\',83,NULL,NULL), (\'6151024202\',\'0\',\'003\',83,NULL,NULL), (\'6161014502\',\'0\',\'012\',48,NULL,NULL), (\'6161024302\',\'0\',\'001\',75,NULL,NULL), (\'6161034102\',\'0\',\'003\',59,NULL,NULL), (\'6161034102\',\'0\',\'004\',59,NULL,NULL), (\'6181014102\',\'0\',\'001\',89,NULL,NULL), (\'6181024102\',\'0\',\'001\',99,NULL,NULL), (\'6181034302\',\'0\',\'001\',95,NULL,NULL), (\'6181044202\',\'0\',\'001\',83,NULL,NULL), (\'6181044302\',\'0\',\'001\',107,NULL,NULL), (\'6181054202\',\'0\',\'001\',77,NULL,NULL), (\'6181054302\',\'0\',\'001\',95,NULL,NULL), (\'6181064302\',\'0\',\'001\',107,NULL,NULL), (\'6191014502\',\'0\',\'001\',104,NULL,NULL), (\'6191024302\',\'0\',\'009\',155,NULL,NULL), (\'6221014402\',\'0\',\'001\',293,NULL,NULL), (\'6221014502\',\'0\',\'001\',132,NULL,NULL), (\'6221014502\',\'0\',\'004\',132,NULL,NULL), (\'6221024202\',\'0\',\'002\',137,NULL,NULL), (\'6221024202\',\'0\',\'003\',137,NULL,NULL), (\'6221024302\',\'0\',\'005\',119,NULL,NULL), (\'6221034202\',\'0\',\'001\',119,NULL,NULL), (\'6221034202\',\'0\',\'003\',119,NULL,NULL), (\'6221034202\',\'0\',\'004\',119,NULL,NULL), (\'6221044302\',\'0\',\'014\',131,NULL,NULL), (\'6221044302\',\'0\',\'015\',131,NULL,NULL), (\'6221044302\',\'0\',\'024\',131,NULL,NULL), (\'6221044402\',\'0\',\'006\',215,NULL,NULL), (\'6221044402\',\'0\',\'007\',215,NULL,NULL), (\'6221054502\',\'0\',\'001\',111,NULL,NULL), (\'6221064402\',\'0\',\'014\',107,NULL,NULL), (\'6221074402\',\'0\',\'002\',155,NULL,NULL), (\'6221074402\',\'0\',\'013\',155,NULL,NULL), (\'6221084102\',\'0\',\'003\',119,NULL,NULL), (\'6221084102\',\'0\',\'004\',119,NULL,NULL), (\'6221084402\',\'0\',\'002\',119,NULL,NULL), (\'6221084402\',\'0\',\'009\',119,NULL,NULL), (\'6221094302\',\'0\',\'008\',101,NULL,NULL), (\'6221094302\',\'0\',\'009\',101,NULL,NULL), (\'6221094302\',\'0\',\'011\',101,NULL,NULL), (\'6221094402\',\'0\',\'002\',107,NULL,NULL), (\'6221094402\',\'0\',\'014\',107,NULL,NULL), (\'6221104402\',\'0\',\'006\',83,NULL,NULL), (\'6221114102\',\'0\',\'002\',119,NULL,NULL), (\'6221114102\',\'0\',\'003\',119,NULL,NULL), (\'6221124102\',\'0\',\'001\',137,NULL,NULL), (\'6221144102\',\'0\',\'001\',137,NULL,NULL), (\'6221154102\',\'0\',\'001\',149,NULL,NULL), (\'6221154402\',\'0\',\'002\',113,NULL,NULL), (\'6221154402\',\'0\',\'007\',113,NULL,NULL), (\'6221154402\',\'0\',\'009\',113,NULL,NULL), (\'6221154402\',\'0\',\'018\',113,NULL,NULL), (\'6221154402\',\'0\',\'020\',113,NULL,NULL), (\'6221154402\',\'0\',\'021\',113,NULL,NULL), (\'6221164102\',\'0\',\'004\',83,NULL,NULL), (\'6221164402\',\'0\',\'001\',95,NULL,NULL), (\'6221164402\',\'0\',\'013\',95,NULL,NULL), (\'6221164402\',\'0\',\'014\',95,NULL,NULL), (\'6221174402\',\'0\',\'011\',117,NULL,NULL), (\'6221174402\',\'0\',\'022\',117,NULL,NULL), (\'6241014302\',\'0\',\'009\',113,NULL,NULL), (\'6241014302\',\'0\',\'010\',113,NULL,NULL), (\'6241024102\',\'0\',\'001\',113,NULL,NULL), (\'6241024102\',\'0\',\'004\',113,NULL,NULL), (\'6241024402\',\'0\',\'001\',119,NULL,NULL), (\'6241024402\',\'0\',\'002\',119,NULL,NULL), (\'6241034402\',\'0\',\'003\',209,NULL,NULL), (\'6291014602\',\'0\',\'001\',71,NULL,NULL), (\'6291014602\',\'0\',\'004\',71,NULL,NULL), (\'6291014602\',\'0\',\'005\',71,NULL,NULL), (\'6321014302\',\'0\',\'004\',113,NULL,NULL), (\'6321014402\',\'0\',\'001\',119,NULL,NULL), (\'6331014102\',\'0\',\'002\',101,NULL,NULL), (\'6331024102\',\'0\',\'001\',101,NULL,NULL), (\'6341014102\',\'0\',\'001\',83,NULL,NULL), (\'6341014102\',\'0\',\'002\',83,NULL,NULL), (\'6341014102\',\'0\',\'004\',83,NULL,NULL), (\'6341014302\',\'0\',\'001\',107,NULL,NULL), (\'6341014402\',\'0\',\'001\',101,NULL,NULL), (\'6341014402\',\'0\',\'003\',101,NULL,NULL), (\'6341024102\',\'0\',\'003\',101,NULL,NULL), (\'6341034102\',\'0\',\'001\',113,NULL,NULL), (\'6341044102\',\'0\',\'001\',113,NULL,NULL), (\'6361014102\',\'0\',\'002\',95,NULL,NULL), (\'6361014102\',\'0\',\'003\',95,NULL,NULL), (\'6361014202\',\'0\',\'001\',83,NULL,NULL), (\'6361014202\',\'0\',\'002\',83,NULL,NULL), (\'6361014302\',\'0\',\'001\',89,NULL,NULL), (\'6361014402\',\'0\',\'001\',89,NULL,NULL), (\'6361014402\',\'0\',\'003\',89,NULL,NULL), (\'6361024102\',\'0\',\'002\',83,NULL,NULL), (\'6361024102\',\'0\',\'003\',83,NULL,NULL), (\'6361024302\',\'0\',\'001\',113,NULL,NULL), (\'6361024402\',\'0\',\'001\',47,NULL,NULL), (\'6361024402\',\'0\',\'002\',47,NULL,NULL), (\'6361034102\',\'0\',\'003\',71,NULL,NULL), (\'6361034202\',\'0\',\'001\',95,NULL,NULL), (\'6361034202\',\'0\',\'002\',95,NULL,NULL), (\'6361034302\',\'0\',\'001\',71,NULL,NULL), (\'6361034302\',\'0\',\'002\',71,NULL,NULL), (\'6361044102\',\'0\',\'001\',95,NULL,NULL), (\'6361044102\',\'0\',\'002\',95,NULL,NULL), (\'6361044202\',\'0\',\'001\',113,NULL,NULL), (\'6361044202\',\'0\',\'002\',113,NULL,NULL), (\'6361054102\',\'0\',\'002\',77,NULL,NULL), (\'6361054102\',\'0\',\'003\',77,NULL,NULL), (\'6361054302\',\'0\',\'001\',71,NULL,NULL), (\'6361054302\',\'0\',\'002\',71,NULL,NULL), (\'6361054302\',\'0\',\'003\',71,NULL,NULL), (\'6361054302\',\'0\',\'004\',71,NULL,NULL), (\'6361064302\',\'0\',\'001\',101,NULL,NULL), (\'6361064302\',\'0\',\'002\',101,NULL,NULL), (\'6361074102\',\'0\',\'001\',173,NULL,NULL), (\'6361074102\',\'0\',\'002\',173,NULL,NULL), (\'6361074102\',\'0\',\'003\',173,NULL,NULL), (\'6361074302\',\'0\',\'001\',89,NULL,NULL), (\'6361084102\',\'0\',\'004\',131,NULL,NULL), (\'6361084102\',\'0\',\'005\',131,NULL,NULL), (\'6361084202\',\'0\',\'001\',113,NULL,NULL), (\'6361104102\',\'0\',\'001\',95,NULL,NULL), (\'6361104102\',\'0\',\'004\',95,NULL,NULL), (\'6361114102\',\'0\',\'001\',101,NULL,NULL), (\'6371014402\',\'0\',\'001\',83,NULL,NULL), (\'6371014402\',\'0\',\'002\',83,NULL,NULL), (\'6381014102\',\'0\',\'008\',119,NULL,NULL), (\'6381014102\',\'0\',\'009\',119,NULL,NULL), (\'6381014102\',\'0\',\'012\',119,NULL,NULL), (\'6441014102\',\'0\',\'001\',269,NULL,NULL), (\'6441034202\',\'0\',\'001\',239,NULL,NULL), (\'6481014202\',\'0\',\'004\',173,NULL,NULL), (\'6481014202\',\'0\',\'007\',173,NULL,NULL), (\'6491014202\',\'0\',\'004\',179,NULL,NULL), (\'6491014202\',\'0\',\'007\',179,NULL,NULL), (\'6501014602\',\'0\',\'001\',47,NULL,NULL), (\'6501014602\',\'0\',\'002\',47,NULL,NULL), (\'6501014702\',\'0\',\'001\',59,NULL,NULL), (\'6501024602\',\'0\',\'001\',41,NULL,NULL), (\'6501024602\',\'0\',\'002\',41,NULL,NULL), (\'6501024602\',\'0\',\'003\',41,NULL,NULL), (\'6501034702\',\'0\',\'001\',35,NULL,NULL), (\'6501034702\',\'0\',\'002\',35,NULL,NULL), (\'6501034702\',\'0\',\'003\',35,NULL,NULL), (\'6501044702\',\'0\',\'001\',47,NULL,NULL), (\'6501054702\',\'0\',\'001\',45,NULL,NULL), (\'6501064702\',\'0\',\'001\',53,NULL,NULL), (\'6511014602\',\'0\',\'001\',89,NULL,NULL), (\'6511014602\',\'0\',\'002\',89,NULL,NULL), (\'6511014602\',\'0\',\'003\',89,NULL,NULL), (\'6511014702\',\'0\',\'001\',71,NULL,NULL), (\'6511024702\',\'0\',\'002\',83,NULL,NULL), (\'6511024702\',\'0\',\'003\',83,NULL,NULL), (\'6511034602\',\'0\',\'001\',113,NULL,NULL), (\'6511034702\',\'0\',\'004\',149,NULL,NULL), (\'6511034702\',\'0\',\'005\',149,NULL,NULL), (\'6511034702\',\'0\',\'006\',149,NULL,NULL), (\'6511044602\',\'0\',\'001\',95,NULL,NULL), (\'6511044702\',\'0\',\'001\',113,NULL,NULL), (\'6511054602\',\'0\',\'001\',83,NULL,NULL), (\'6511054602\',\'0\',\'002\',83,NULL,NULL), (\'6511054602\',\'0\',\'003\',83,NULL,NULL), (\'6511054702\',\'0\',\'001\',59,NULL,NULL), (\'6511064602\',\'0\',\'001\',59,NULL,NULL), (\'6511064602\',\'0\',\'002\',59,NULL,NULL), (\'6511064702\',\'0\',\'001\',59,NULL,NULL), (\'6511064702\',\'0\',\'002\',59,NULL,NULL), (\'6511064702\',\'0\',\'003\',59,NULL,NULL), (\'6521014602\',\'0\',\'001\',101,NULL,NULL), (\'6521014602\',\'0\',\'002\',101,NULL,NULL), (\'6521014602\',\'0\',\'003\',101,NULL,NULL), (\'6521014702\',\'0\',\'001\',107,NULL,NULL), (\'6521014702\',\'0\',\'002\',107,NULL,NULL), (\'6521014702\',\'0\',\'003\',107,NULL,NULL), (\'6521024602\',\'0\',\'002\',101,NULL,NULL), (\'6521034602\',\'0\',\'001\',137,NULL,NULL), (\'6521044702\',\'0\',\'001\',137,NULL,NULL), (\'6521044702\',\'0\',\'002\',137,NULL,NULL), (\'6521054702\',\'0\',\'001\',155,NULL,NULL), (\'6521054702\',\'0\',\'002\',155,NULL,NULL), (\'6521054702\',\'0\',\'003\',155,NULL,NULL), (\'6521054702\',\'0\',\'004\',155,NULL,NULL), (\'6521054702\',\'0\',\'005\',155,NULL,NULL), (\'6521064702\',\'0\',\'001\',119,NULL,NULL), (\'6521084702\',\'0\',\'001\',119,NULL,NULL), (\'6521094702\',\'0\',\'001\',119,NULL,NULL), (\'6521094702\',\'0\',\'002\',119,NULL,NULL), (\'6541014702\',\'0\',\'001\',45,NULL,NULL), (\'6541014702\',\'0\',\'002\',45,NULL,NULL), (\'6541024602\',\'0\',\'001\',59,NULL,NULL), (\'6541024602\',\'0\',\'002\',59,NULL,NULL), (\'6541024602\',\'0\',\'003\',59,NULL,NULL), (\'6541024702\',\'0\',\'001\',53,NULL,NULL), (\'6541024702\',\'0\',\'002\',53,NULL,NULL), (\'6541024702\',\'0\',\'003\',53,NULL,NULL), (\'6541034602\',\'0\',\'001\',41,NULL,NULL), (\'6541034602\',\'0\',\'002\',41,NULL,NULL), (\'6541034602\',\'0\',\'003\',41,NULL,NULL), (\'6541034702\',\'0\',\'001\',47,NULL,NULL), (\'6541034702\',\'0\',\'002\',47,NULL,NULL), (\'6541034702\',\'0\',\'003\',47,NULL,NULL), (\'6541034702\',\'0\',\'004\',47,NULL,NULL), (\'6541044702\',\'0\',\'001\',35,NULL,NULL), (\'6541044702\',\'0\',\'002\',35,NULL,NULL), (\'6571014602\',\'0\',\'001\',35,NULL,NULL), (\'6571014602\',\'0\',\'002\',35,NULL,NULL), (\'6571014702\',\'0\',\'001\',35,NULL,NULL), (\'6571014702\',\'0\',\'002\',35,NULL,NULL), (\'6571024702\',\'0\',\'001\',47,NULL,NULL), (\'6571034602\',\'0\',\'001\',47,NULL,NULL), (\'6571034602\',\'0\',\'002\',47,NULL,NULL), (\'6571034602\',\'0\',\'003\',47,NULL,NULL), (\'6611014602\',\'0\',\'001\',59,NULL,NULL), (\'6611014602\',\'0\',\'002\',59,NULL,NULL), (\'6611014602\',\'0\',\'003\',59,NULL,NULL), (\'6621014102\',\'0\',\'001\',113,NULL,NULL), (\'6621014202\',\'0\',\'001\',89,NULL,NULL), (\'6621014302\',\'0\',\'001\',101,NULL,NULL), (\'6621014302\',\'0\',\'002\',101,NULL,NULL), (\'6621014302\',\'0\',\'004\',101,NULL,NULL), (\'6621014502\',\'0\',\'001\',139,NULL,NULL), (\'6621014502\',\'0\',\'002\',139,NULL,NULL), (\'6621014802\',\'0\',\'001\',107,NULL,NULL), (\'6621024102\',\'0\',\'001\',119,NULL,NULL), (\'6621024402\',\'0\',\'001\',83,NULL,NULL), (\'6621024402\',\'0\',\'002\',83,NULL,NULL), (\'6621034302\',\'0\',\'001\',131,NULL,NULL), (\'6621034302\',\'0\',\'002\',131,NULL,NULL), (\'6621034402\',\'0\',\'001\',101,NULL,NULL), (\'6621034402\',\'0\',\'003\',101,NULL,NULL), (\'6621044102\',\'0\',\'005\',101,NULL,NULL), (\'6621044402\',\'0\',\'001\',119,NULL,NULL), (\'6621044402\',\'0\',\'002\',119,NULL,NULL), (\'6621044402\',\'0\',\'003\',119,NULL,NULL), (\'6621054402\',\'0\',\'001\',101,NULL,NULL), (\'6621064402\',\'0\',\'001\',113,NULL,NULL), (\'6621064402\',\'0\',\'002\',113,NULL,NULL), (\'6621074102\',\'0\',\'002\',113,NULL,NULL), (\'6621074402\',\'0\',\'001\',113,NULL,NULL), (\'6621074402\',\'0\',\'002\',113,NULL,NULL), (\'6621084102\',\'0\',\'001\',107,NULL,NULL), (\'6621084102\',\'0\',\'003\',107,NULL,NULL), (\'6631014402\',\'0\',\'001\',113,NULL,NULL), (\'6631014402\',\'0\',\'002\',113,NULL,NULL), (\'6631024102\',\'0\',\'001\',137,NULL,NULL), (\'6641014102\',\'0\',\'001\',131,NULL,NULL), (\'6641014402\',\'0\',\'001\',107,NULL,NULL), (\'6641014402\',\'0\',\'002\',107,NULL,NULL), (\'6751014702\',\'0\',\'001\',41,NULL,NULL), (\'6751014802\',\'0\',\'001\',51,NULL,NULL), (\'6751024602\',\'0\',\'001\',41,NULL,NULL), (\'6751024802\',\'0\',\'001\',59,NULL,NULL), (\'6751034602\',\'0\',\'001\',41,NULL,NULL), (\'6751034602\',\'0\',\'002\',41,NULL,NULL), (\'6751034802\',\'0\',\'001\',71,NULL,NULL), (\'6751044802\',\'0\',\'001\',77,NULL,NULL), (\'6761014602\',\'0\',\'001\',101,NULL,NULL), (\'6761014602\',\'0\',\'002\',101,NULL,NULL), (\'6761014602\',\'0\',\'003\',101,NULL,NULL), (\'6771014102\',\'0\',\'001\',65,NULL,NULL), (\'6771014102\',\'0\',\'002\',65,NULL,NULL), (\'6771014302\',\'0\',\'001\',95,NULL,NULL), (\'6771014302\',\'0\',\'002\',95,NULL,NULL), (\'6771014402\',\'0\',\'001\',101,NULL,NULL), (\'6771014402\',\'0\',\'002\',101,NULL,NULL), (\'6771014402\',\'0\',\'003\',101,NULL,NULL), (\'6771024302\',\'0\',\'001\',113,NULL,NULL), (\'6771024302\',\'0\',\'002\',113,NULL,NULL), (\'6771024402\',\'0\',\'001\',77,NULL,NULL), (\'6771024402\',\'0\',\'002\',77,NULL,NULL), (\'6771034302\',\'0\',\'001\',83,NULL,NULL), (\'6771034302\',\'0\',\'002\',83,NULL,NULL), (\'6781014102\',\'0\',\'001\',95,NULL,NULL), (\'6781014202\',\'0\',\'001\',95,NULL,NULL), (\'6781014202\',\'0\',\'002\',95,NULL,NULL), (\'6781014302\',\'0\',\'001\',89,NULL,NULL), (\'6781014302\',\'0\',\'002\',89,NULL,NULL), (\'6781014402\',\'0\',\'001\',83,NULL,NULL), (\'6781024202\',\'0\',\'001\',89,NULL,NULL), (\'6781024202\',\'0\',\'002\',89,NULL,NULL), (\'6781024302\',\'0\',\'001\',101,NULL,NULL), (\'6781024302\',\'0\',\'003\',101,NULL,NULL), (\'6781024302\',\'0\',\'004\',101,NULL,NULL), (\'6781024402\',\'0\',\'002\',83,NULL,NULL), (\'6781024402\',\'0\',\'003\',83,NULL,NULL), (\'6791014602\',\'0\',\'001\',215,NULL,NULL), (\'6791034602\',\'0\',\'001\',173,NULL,NULL), (\'6901014202\',\'0\',\'001\',119,NULL,NULL), (\'6901014202\',\'0\',\'002\',119,NULL,NULL), (\'6911014102\',\'0\',\'001\',107,NULL,NULL), (\'6911014102\',\'0\',\'002\',107,NULL,NULL), (\'6911014202\',\'0\',\'001\',107,NULL,NULL), (\'6911014202\',\'0\',\'002\',107,NULL,NULL), (\'6911014202\',\'0\',\'003\',107,NULL,NULL), (\'6911014302\',\'0\',\'001\',131,NULL,NULL), (\'6911014302\',\'0\',\'002\',131,NULL,NULL), (\'6911014402\',\'0\',\'001\',107,NULL,NULL), (\'6911024202\',\'0\',\'001\',89,NULL,NULL), (\'6911024202\',\'0\',\'002\',89,NULL,NULL), (\'6921014302\',\'0\',\'001\',95,NULL,NULL), (\'6921014302\',\'0\',\'002\',95,NULL,NULL), (\'6941014102\',\'0\',\'002\',47,NULL,NULL), (\'6941014102\',\'0\',\'003\',47,NULL,NULL), (\'6941014102\',\'0\',\'004\',47,NULL,NULL), (\'6941014402\',\'0\',\'001\',33,NULL,NULL), (\'6941014402\',\'0\',\'002\',33,NULL,NULL), (\'6941014402\',\'0\',\'003\',33,NULL,NULL), (\'6941014402\',\'0\',\'004\',33,NULL,NULL), (\'6941014802\',\'0\',\'001\',59,NULL,NULL), (\'6941014802\',\'0\',\'002\',59,NULL,NULL), (\'6941014802\',\'0\',\'003\',59,NULL,NULL), (\'6941014802\',\'0\',\'004\',59,NULL,NULL), (\'6941024102\',\'0\',\'001\',53,NULL,NULL), (\'6941024102\',\'0\',\'002\',53,NULL,NULL), (\'6941024102\',\'0\',\'003\',53,NULL,NULL), (\'6941024202\',\'0\',\'001\',65,NULL,NULL), (\'6941024202\',\'0\',\'002\',65,NULL,NULL), (\'6941024202\',\'0\',\'003\',65,NULL,NULL), (\'6941024302\',\'0\',\'001\',51,NULL,NULL), (\'6941024302\',\'0\',\'002\',51,NULL,NULL), (\'6941024302\',\'0\',\'003\',51,NULL,NULL), (\'6941024402\',\'0\',\'001\',29,NULL,NULL), (\'6941024402\',\'0\',\'002\',29,NULL,NULL), (\'6941024402\',\'0\',\'003\',29,NULL,NULL), (\'6941024402\',\'0\',\'004\',29,NULL,NULL), (\'6941024802\',\'0\',\'005\',53,NULL,NULL), (\'6941034202\',\'0\',\'004\',53,NULL,NULL), (\'6941034402\',\'0\',\'001\',59,NULL,NULL), (\'6941034402\',\'0\',\'002\',59,NULL,NULL), (\'6941034802\',\'0\',\'001\',53,NULL,NULL), (\'6941044802\',\'0\',\'001\',47,NULL,NULL), (\'6941054402\',\'0\',\'001\',47,NULL,NULL), (\'6941054402\',\'0\',\'002\',47,NULL,NULL), (\'6941054402\',\'0\',\'003\',47,NULL,NULL), (\'6941054802\',\'0\',\'002\',53,NULL,NULL), (\'6941054802\',\'0\',\'003\',53,NULL,NULL), (\'6941054802\',\'0\',\'004\',53,NULL,NULL), (\'6941064402\',\'0\',\'001\',65,NULL,NULL), (\'6941064402\',\'0\',\'004\',65,NULL,NULL), (\'6941074402\',\'0\',\'005\',41,NULL,NULL), (\'6941084402\',\'0\',\'001\',59,NULL,NULL), (\'6941094402\',\'0\',\'002\',41,NULL,NULL), (\'6941094402\',\'0\',\'003\',41,NULL,NULL), (\'6941094402\',\'0\',\'004\',41,NULL,NULL), (\'6951014102\',\'0\',\'001\',83,NULL,NULL), (\'6951014202\',\'0\',\'001\',75,NULL,NULL), (\'6951014202\',\'0\',\'002\',75,NULL,NULL), (\'6951014402\',\'0\',\'001\',77,NULL,NULL), (\'6951014402\',\'0\',\'003\',77,NULL,NULL), (\'6951014502\',\'0\',\'001\',69,NULL,NULL), (\'6951014502\',\'0\',\'002\',69,NULL,NULL), (\'6951024202\',\'0\',\'001\',59,NULL,NULL), (\'6971014302\',\'0\',\'001\',65,NULL,NULL), (\'6971014302\',\'0\',\'002\',65,NULL,NULL), (\'6971014302\',\'0\',\'003\',65,NULL,NULL), (\'6971014302\',\'0\',\'004\',65,NULL,NULL), (\'6971014402\',\'0\',\'006\',47,NULL,NULL), (\'6971024102\',\'0\',\'001\',53,NULL,NULL), (\'6971024302\',\'0\',\'001\',35,NULL,NULL), (\'6971024302\',\'0\',\'002\',35,NULL,NULL), (\'6971024302\',\'0\',\'003\',35,NULL,NULL), (\'6971024402\',\'0\',\'001\',59,NULL,NULL), (\'6971024402\',\'0\',\'002\',59,NULL,NULL), (\'6971024402\',\'0\',\'003\',59,NULL,NULL), (\'6971024402\',\'0\',\'004\',59,NULL,NULL), (\'8041014102\',\'0\',\'001\',137,NULL,NULL), (\'8041014202\',\'0\',\'001\',227,NULL,NULL), (\'8041014702\',\'0\',\'002\',161,NULL,NULL), (\'8041034802\',\'0\',\'001\',149,NULL,NULL), (\'8041034902\',\'0\',\'005\',137,NULL,NULL), (\'8041044802\',\'0\',\'001\',209,NULL,NULL), (\'8041044802\',\'0\',\'002\',209,NULL,NULL), (\'8041044802\',\'0\',\'003\',209,NULL,NULL), (\'8081014202\',\'0\',\'001\',239,NULL,NULL), (\'8081024202\',\'0\',\'002\',299,NULL,NULL), (\'8101014102\',\'0\',\'001\',107,NULL,NULL), (\'8101014202\',\'0\',\'010\',129,NULL,NULL), (\'8101014702\',\'0\',\'001\',71,NULL,NULL), (\'8101014702\',\'0\',\'002\',71,NULL,NULL), (\'8101024102\',\'0\',\'001\',77,NULL,NULL), (\'8101024102\',\'0\',\'002\',77,NULL,NULL), (\'8101024702\',\'0\',\'001\',77,NULL,NULL), (\'8101024702\',\'0\',\'002\',77,NULL,NULL), (\'8111024102\',\'0\',\'001\',83,NULL,NULL), (\'8111024102\',\'0\',\'002\',83,NULL,NULL), (\'8111024202\',\'0\',\'001\',113,NULL,NULL), (\'8111024802\',\'0\',\'016\',71,NULL,NULL), (\'8111024802\',\'0\',\'017\',71,NULL,NULL), (\'8111024802\',\'0\',\'018\',71,NULL,NULL), (\'8111034802\',\'0\',\'013\',83,NULL,NULL), (\'8111034802\',\'0\',\'023\',83,NULL,NULL), (\'8111044102\',\'0\',\'001\',83,NULL,NULL), (\'8111044802\',\'0\',\'014\',90,NULL,NULL), (\'8111044802\',\'0\',\'023\',90,NULL,NULL), (\'8111054802\',\'0\',\'001\',111,NULL,NULL), (\'8111054802\',\'0\',\'007\',111,NULL,NULL), (\'8111054802\',\'0\',\'008\',111,NULL,NULL), (\'8111064802\',\'0\',\'001\',118,NULL,NULL), (\'8111064802\',\'0\',\'007\',118,NULL,NULL), (\'8111064802\',\'0\',\'009\',118,NULL,NULL), (\'8121014202\',\'0\',\'002\',239,NULL,NULL), (\'8131014102\',\'0\',\'002\',107,NULL,NULL), (\'8131014702\',\'0\',\'001\',101,NULL,NULL), (\'8131014702\',\'0\',\'002\',101,NULL,NULL), (\'8131014902\',\'0\',\'001\',65,NULL,NULL), (\'8131024202\',\'0\',\'002\',113,NULL,NULL), (\'8131044802\',\'0\',\'016\',83,NULL,NULL), (\'8131044802\',\'0\',\'017\',83,NULL,NULL), (\'8131044802\',\'0\',\'018\',83,NULL,NULL), (\'8131054802\',\'0\',\'001\',125,NULL,NULL), (\'8131054802\',\'0\',\'008\',125,NULL,NULL), (\'8131054802\',\'0\',\'009\',125,NULL,NULL), (\'8131064902\',\'0\',\'004\',125,NULL,NULL), (\'8131074902\',\'0\',\'005\',65,NULL,NULL), (\'8131084802\',\'0\',\'001\',118,NULL,NULL), (\'8131084802\',\'0\',\'002\',118,NULL,NULL), (\'8131084802\',\'0\',\'003\',118,NULL,NULL), (\'8131094802\',\'0\',\'001\',125,NULL,NULL), (\'8131094802\',\'0\',\'002\',125,NULL,NULL), (\'8131094802\',\'0\',\'003\',125,NULL,NULL), (\'8141014202\',\'0\',\'001\',83,NULL,NULL), (\'8141014702\',\'0\',\'002\',71,NULL,NULL), (\'8141024202\',\'0\',\'001\',83,NULL,NULL), (\'8151014202\',\'0\',\'001\',179,NULL,NULL), (\'8151014702\',\'0\',\'001\',131,NULL,NULL), (\'8151014702\',\'0\',\'002\',131,NULL,NULL), (\'8151014802\',\'0\',\'001\',119,NULL,NULL), (\'8151014802\',\'0\',\'002\',119,NULL,NULL), (\'8151014802\',\'0\',\'005\',119,NULL,NULL), (\'8151024802\',\'0\',\'001\',77,NULL,NULL), (\'8151034802\',\'0\',\'001\',111,NULL,NULL), (\'8151034802\',\'0\',\'008\',111,NULL,NULL), (\'8151034802\',\'0\',\'009\',111,NULL,NULL), (\'8161014702\',\'0\',\'001\',41,NULL,NULL), (\'8161014702\',\'0\',\'002\',41,NULL,NULL), (\'8181014102\',\'0\',\'001\',119,NULL,NULL), (\'8181014802\',\'0\',\'001\',107,NULL,NULL), (\'8221014102\',\'0\',\'002\',101,NULL,NULL), (\'8221014202\',\'0\',\'002\',113,NULL,NULL), (\'8221014702\',\'0\',\'001\',89,NULL,NULL), (\'8221014802\',\'0\',\'001\',119,NULL,NULL), (\'8221014802\',\'0\',\'002\',119,NULL,NULL), (\'8221014802\',\'0\',\'003\',119,NULL,NULL), (\'8221014902\',\'0\',\'005\',113,NULL,NULL), (\'8221014902\',\'0\',\'022\',113,NULL,NULL), (\'8221024202\',\'0\',\'009\',197,NULL,NULL), (\'8221024802\',\'0\',\'001\',167,NULL,NULL), (\'8221024802\',\'0\',\'006\',167,NULL,NULL), (\'8221024802\',\'0\',\'008\',167,NULL,NULL), (\'8221034202\',\'0\',\'002\',191,NULL,NULL), (\'8221044202\',\'0\',\'003\',173,NULL,NULL), (\'8221044202\',\'0\',\'005\',173,NULL,NULL), (\'8221054202\',\'0\',\'006\',257,NULL,NULL), (\'8221064202\',\'0\',\'007\',221,NULL,NULL), (\'8221094202\',\'0\',\'005\',107,NULL,NULL), (\'8221104202\',\'0\',\'011\',215,NULL,NULL), (\'8241024202\',\'0\',\'001\',149,NULL,NULL)"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "REPLACE INTO catalogo_b2e_varianti_prezzi\\n\\t\\t\\t\\t\\t\\t\\t\\tSELECT prz.modello as modello_principale, var.variante, \'0100107\' as cod_negozio, prz.prezzo_s, prz.prezzo_p, prz.prezzo_c\\n\\t\\t\\t\\t\\t\\t\\t\\tFROM catalogo_b2e_prezzi_tmp prz\\n\\t\\t\\t\\t\\t\\t\\t\\tLEFT JOIN catalogo_b2e_varianti AS var ON var.modello = prz.modello AND var.pezzo = prz.pezzo\\n\\t\\t\\t\\t\\t\\t\\t\\tWHERE (prz.variante = \'all\' OR prz.variante = var.variante);"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp;"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10de995b0>
INFO:root:Verifica dei prezzi di saldo per pezzo = 0, processing 948/948 modelli (negozio 0100107)
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10de67a90> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 17ms, 502] SELECT IFNULL(prezzo,0) AS prezzo_listino, IFNULL(prezzo,0) AS prezzo_attuale, IFNULL(perc,0) AS perc_attuale, 			divisa, IFNULL(tipo_prezzo,'') AS tipo_prezzo, data_inizio_validita, data_fine_validita, modello, 				variante, id_listino 		FROM prezzi 		WHERE cod_negozio = ? 		AND modello IN (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 		AND pezzo = ? 		AND tipo_prezzo IN (?,?,?,?,?,?,?) (params: ('0100107', '8301014602', '8321014202', '8341014102', '8341014602', '8341014702', '8346014102', '8346024802', '8361014102', '8361014202', '8361014602', '8361024102', '8361024602', '8361034602', '8364964902', '8364974902', '8364984902', '8364994402', '8364994902', '8366014102', '8366014202', '8366014902', '8366024202', '8366024802', '8366024902', '8366034802', '8366044802', '8366054802', '8366064802', '8366074802', '8366084802', '8366094802', '8369954402', '8369964402', '8369974402', '8369984402', '8369994402', '8456014202', '8456024202', '8471014102', '8496014202', '8501014102', '8501014802', '8501024802', '8506014802', '8511014202', '8511014802', '8511014902', '8511024102', '8511024202', '8511024902', '8516014102', '8516014902', '8521014202', '8521014702', '8521014902', '8521024202', '8541014202', '8546014202', '8546014902', '8571014102', '8571024102', '8571034102', '8576014102', '8576014202', '8576014802', '8611014602', '8621014902', '8621024902', '8621034902', '8621044902', '8626024202', '8646014202', '8711014102', '8736014802', '8741014102', '8761014402', '8766014402', '8771014602', '8771014802', '8776014202', '8781014902', '8786014202', '8786014902', '8791014202', '8796014902', '8801014302', '8801024302', '8801034302', '8801044302', '8801054302', '8801064302', '8801084302', '8806014302', '8806024302', '8806034302', '8806044302', '8806054302', '8806154302', '8806164302', '8806204302', '8901014802', '8906014202', '8906024202', '8911014802', '8916014202', '8921014602', '8926014102', '8936014202', '8941014202', '8941014402', '8941014702', '8941014802', '8941014902', '8941024402', '8941024702', '8941024802', '8941024902', '8941034402', '8941034902', '8941044402', '8941054402', '8946014402', '8946014902', '8946024402', '8946024802', '8946034402', '8946034802', '8946044402', '8946054402', '8951014802', '8951014902', '8951024902', '8971014102', '8971014202', '8971014402', '8971014602', '8971014902', '8971024102', '8971024402', '8971034102', '8976014102', '8976014202', '8976014402', '8976024102', '8976024402', '8976034102', '8996014102', '8996024102', '0', 'V', 'S', 'E', 'M', 'R', 'P', 'C'))
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10de67a90>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6130>
DEBUG:root:Gestione listino esteso: ON
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10ddb7fd0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 1] SELECT id_listino, tipo_prezzo, data_inizio_validita, data_fine_validita, annostag 		FROM listino_prezzi 		WHERE cod_negozio = ? 		AND data_inizio_validita != '' 		AND data_fine_validita != '' 		AND data_inizio_validita <= ? 		AND data_fine_validita >= ? (params: ('0100107', '20240719', '20240719'))
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10ddb7fd0>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10ddb7fd0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10ddb7fd0>
DEBUG:root:Listini di prezzi abbattuti validi oggi: S (id 13444)
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10dde6f10> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp; 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] CREATE TABLE catalogo_b2e_prezzi_tmp ( 									modello VARCHAR(100), 	pezzo VARCHAR(100), 									variante VARCHAR(100), 									prezzo_s decimal(13, 2), prezzo_p decimal(13, 2), prezzo_c decimal(13, 2) 								); 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] INSERT INTO catalogo_b2e_prezzi_tmp (modello, pezzo, variante, prezzo_s, prezzo_p, prezzo_c) 					VALUES ('8301014602','0','001',95,NULL,NULL), ('8321014202','0','001',149,NULL,NULL), ('8341014102','0','005',161,NULL,NULL), ('8341014602','0','001',125,NULL,NULL), ('8361014102','0','001',101,NULL,NULL), ('8361014102','0','002',101,NULL,NULL), ('8361014102','0','003',101,NULL,NULL), ('8361014202','0','002',77,NULL,NULL), ('8361014602','0','001',65,NULL,NULL), ('8361014602','0','002',65,NULL,NULL), ('8361024102','0','003',125,NULL,NULL), ('8361024102','0','004',125,NULL,NULL), ('8361024602','0','001',113,NULL,NULL), ('8361024602','0','002',113,NULL,NULL), ('8361034602','0','002',143,NULL,NULL), ('8361034602','0','003',143,NULL,NULL), ('8361034602','0','004',143,NULL,NULL), ('8471014102','0','001',347,NULL,NULL), ('8501014102','0','001',41,NULL,NULL), ('8511014202','0','001',95,NULL,NULL), ('8511014802','0','002',59,NULL,NULL), ('8511014802','0','004',59,NULL,NULL), ('8511024102','0','001',101,NULL,NULL), ('8511024202','0','001',95,NULL,NULL), ('8521014202','0','001',119,NULL,NULL), ('8521014702','0','001',131,NULL,NULL), ('8521014702','0','002',131,NULL,NULL), ('8521024202','0','001',77,NULL,NULL), ('8541014202','0','001',53,NULL,NULL), ('8571014102','0','001',41,NULL,NULL), ('8571014102','0','003',41,NULL,NULL), ('8571024102','0','001',47,NULL,NULL), ('8571024102','0','002',47,NULL,NULL), ('8571034102','0','002',47,NULL,NULL), ('8611014602','0','001',47,NULL,NULL), ('8711014102','0','001',47,NULL,NULL), ('8711014102','0','002',47,NULL,NULL), ('8741014102','0','001',59,NULL,NULL), ('8741014102','0','002',59,NULL,NULL), ('8771014602','0','001',95,NULL,NULL), ('8771014802','0','001',89,NULL,NULL), ('8771014802','0','002',89,NULL,NULL), ('8791014202','0','002',161,NULL,NULL), ('8901014802','0','001',197,NULL,NULL), ('8901014802','0','002',197,NULL,NULL), ('8911014802','0','001',119,NULL,NULL), ('8911014802','0','002',119,NULL,NULL), ('8921014602','0','001',101,NULL,NULL), ('8941014202','0','001',47,NULL,NULL), ('8941014702','0','001',41,NULL,NULL), ('8941014702','0','002',41,NULL,NULL), ('8941014702','0','003',41,NULL,NULL), ('8941014802','0','001',69,NULL,NULL), ('8941014802','0','002',69,NULL,NULL), ('8941014802','0','003',69,NULL,NULL), ('8941024702','0','001',35,NULL,NULL), ('8941024702','0','002',35,NULL,NULL), ('8941024802','0','001',76,NULL,NULL), ('8941024802','0','002',76,NULL,NULL), ('8941024802','0','004',76,NULL,NULL), ('8941024902','0','001',51,NULL,NULL), ('8941024902','0','002',51,NULL,NULL), ('8951014802','0','004',83,NULL,NULL), ('8971014102','0','001',53,NULL,NULL), ('8971014102','0','002',53,NULL,NULL), ('8971014202','0','001',53,NULL,NULL), ('8971014602','0','001',59,NULL,NULL), ('8971014602','0','002',59,NULL,NULL), ('8971014602','0','003',59,NULL,NULL), ('8971024102','0','001',47,NULL,NULL), ('8971024102','0','002',47,NULL,NULL), ('8971034102','0','001',59,NULL,NULL) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] REPLACE INTO catalogo_b2e_varianti_prezzi 								SELECT prz.modello as modello_principale, var.variante, '0100107' as cod_negozio, prz.prezzo_s, prz.prezzo_p, prz.prezzo_c 								FROM catalogo_b2e_prezzi_tmp przLEFT JOIN catalogo_b2e_varianti AS var ON var.modello = prz.modello AND var.pezzo = prz.pezzo 								WHERE (prz.variante = 'all' OR prz.variante = var.variante); 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms, 0] DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp; 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10dde6f10>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6f10> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp;"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE catalogo_b2e_prezzi_tmp (\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tmodello VARCHAR(100),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tpezzo VARCHAR(100),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvariante VARCHAR(100),\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tprezzo_s decimal(13, 2),\\nprezzo_p decimal(13, 2),\\nprezzo_c decimal(13, 2)\\n\\t\\t\\t\\t\\t\\t\\t\\t);"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO catalogo_b2e_prezzi_tmp (modello, pezzo, variante, prezzo_s, prezzo_p, prezzo_c)\\n\\t\\t\\t\\t\\t\\t\\t\\tVALUES (\'8301014602\',\'0\',\'001\',95,NULL,NULL), (\'8321014202\',\'0\',\'001\',149,NULL,NULL), (\'8341014102\',\'0\',\'005\',161,NULL,NULL), (\'8341014602\',\'0\',\'001\',125,NULL,NULL), (\'8361014102\',\'0\',\'001\',101,NULL,NULL), (\'8361014102\',\'0\',\'002\',101,NULL,NULL), (\'8361014102\',\'0\',\'003\',101,NULL,NULL), (\'8361014202\',\'0\',\'002\',77,NULL,NULL), (\'8361014602\',\'0\',\'001\',65,NULL,NULL), (\'8361014602\',\'0\',\'002\',65,NULL,NULL), (\'8361024102\',\'0\',\'003\',125,NULL,NULL), (\'8361024102\',\'0\',\'004\',125,NULL,NULL), (\'8361024602\',\'0\',\'001\',113,NULL,NULL), (\'8361024602\',\'0\',\'002\',113,NULL,NULL), (\'8361034602\',\'0\',\'002\',143,NULL,NULL), (\'8361034602\',\'0\',\'003\',143,NULL,NULL), (\'8361034602\',\'0\',\'004\',143,NULL,NULL), (\'8471014102\',\'0\',\'001\',347,NULL,NULL), (\'8501014102\',\'0\',\'001\',41,NULL,NULL), (\'8511014202\',\'0\',\'001\',95,NULL,NULL), (\'8511014802\',\'0\',\'002\',59,NULL,NULL), (\'8511014802\',\'0\',\'004\',59,NULL,NULL), (\'8511024102\',\'0\',\'001\',101,NULL,NULL), (\'8511024202\',\'0\',\'001\',95,NULL,NULL), (\'8521014202\',\'0\',\'001\',119,NULL,NULL), (\'8521014702\',\'0\',\'001\',131,NULL,NULL), (\'8521014702\',\'0\',\'002\',131,NULL,NULL), (\'8521024202\',\'0\',\'001\',77,NULL,NULL), (\'8541014202\',\'0\',\'001\',53,NULL,NULL), (\'8571014102\',\'0\',\'001\',41,NULL,NULL), (\'8571014102\',\'0\',\'003\',41,NULL,NULL), (\'8571024102\',\'0\',\'001\',47,NULL,NULL), (\'8571024102\',\'0\',\'002\',47,NULL,NULL), (\'8571034102\',\'0\',\'002\',47,NULL,NULL), (\'8611014602\',\'0\',\'001\',47,NULL,NULL), (\'8711014102\',\'0\',\'001\',47,NULL,NULL), (\'8711014102\',\'0\',\'002\',47,NULL,NULL), (\'8741014102\',\'0\',\'001\',59,NULL,NULL), (\'8741014102\',\'0\',\'002\',59,NULL,NULL), (\'8771014602\',\'0\',\'001\',95,NULL,NULL), (\'8771014802\',\'0\',\'001\',89,NULL,NULL), (\'8771014802\',\'0\',\'002\',89,NULL,NULL), (\'8791014202\',\'0\',\'002\',161,NULL,NULL), (\'8901014802\',\'0\',\'001\',197,NULL,NULL), (\'8901014802\',\'0\',\'002\',197,NULL,NULL), (\'8911014802\',\'0\',\'001\',119,NULL,NULL), (\'8911014802\',\'0\',\'002\',119,NULL,NULL), (\'8921014602\',\'0\',\'001\',101,NULL,NULL), (\'8941014202\',\'0\',\'001\',47,NULL,NULL), (\'8941014702\',\'0\',\'001\',41,NULL,NULL), (\'8941014702\',\'0\',\'002\',41,NULL,NULL), (\'8941014702\',\'0\',\'003\',41,NULL,NULL), (\'8941014802\',\'0\',\'001\',69,NULL,NULL), (\'8941014802\',\'0\',\'002\',69,NULL,NULL), (\'8941014802\',\'0\',\'003\',69,NULL,NULL), (\'8941024702\',\'0\',\'001\',35,NULL,NULL), (\'8941024702\',\'0\',\'002\',35,NULL,NULL), (\'8941024802\',\'0\',\'001\',76,NULL,NULL), (\'8941024802\',\'0\',\'002\',76,NULL,NULL), (\'8941024802\',\'0\',\'004\',76,NULL,NULL), (\'8941024902\',\'0\',\'001\',51,NULL,NULL), (\'8941024902\',\'0\',\'002\',51,NULL,NULL), (\'8951014802\',\'0\',\'004\',83,NULL,NULL), (\'8971014102\',\'0\',\'001\',53,NULL,NULL), (\'8971014102\',\'0\',\'002\',53,NULL,NULL), (\'8971014202\',\'0\',\'001\',53,NULL,NULL), (\'8971014602\',\'0\',\'001\',59,NULL,NULL), (\'8971014602\',\'0\',\'002\',59,NULL,NULL), (\'8971014602\',\'0\',\'003\',59,NULL,NULL), (\'8971024102\',\'0\',\'001\',47,NULL,NULL), (\'8971024102\',\'0\',\'002\',47,NULL,NULL), (\'8971034102\',\'0\',\'001\',59,NULL,NULL)"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "REPLACE INTO catalogo_b2e_varianti_prezzi\\n\\t\\t\\t\\t\\t\\t\\t\\tSELECT prz.modello as modello_principale, var.variante, \'0100107\' as cod_negozio, prz.prezzo_s, prz.prezzo_p, prz.prezzo_c\\n\\t\\t\\t\\t\\t\\t\\t\\tFROM catalogo_b2e_prezzi_tmp prz\\n\\t\\t\\t\\t\\t\\t\\t\\tLEFT JOIN catalogo_b2e_varianti AS var ON var.modello = prz.modello AND var.pezzo = prz.pezzo\\n\\t\\t\\t\\t\\t\\t\\t\\tWHERE (prz.variante = \'all\' OR prz.variante = var.variante);"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_b2e_prezzi_tmp;"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6f10>
INFO:root:Inserimento dei prezzi di saldo S P C completato con successo
INFO:root:Composizione tabella _l_20240719162837_136_catalogo_filtri
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] CREATE TABLE _l_20240719162837_136_catalogo_filtri ( 			cod_marchio varchar(2) NOT NULL,cod_sottocategoria_b2c int NOT NULL,lingua varchar(6) NOT NULL,filter_code varchar(50) NOT NULL,filter_name varchar(50) NOT NULL,filter_value varchar(100) NOT NULL,filter_value_code varchar(100) 		, PRIMARY KEY (cod_marchio,cod_sottocategoria_b2c,lingua,filter_code,filter_name,filter_value,filter_value_code) 		) 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10dde6130>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "CREATE TABLE _l_20240719162837_136_catalogo_filtri (\\n\\t\\t\\tcod_marchio varchar(2) NOT NULL,cod_sottocategoria_b2c int NOT NULL,lingua varchar(6) NOT NULL,filter_code varchar(50) NOT NULL,filter_name varchar(50) NOT NULL,filter_value varchar(100) NOT NULL,filter_value_code varchar(100)\\n\\t\\t\\t, PRIMARY KEY (cod_marchio,cod_sottocategoria_b2c,lingua,filter_code,filter_name,filter_value,filter_value_code)\\n\\t\\t)"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6130>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 21ms, 0] INSERT INTO _l_20240719162837_136_catalogo_filtri  			select  				cat.cod_marchio cod_marchio 				, cat.cod_sottocategoria_b2c cod_sottocategoria_b2c 				, cat_fil.lingua lingua 				, cat_fil.filter_code filter_code 				, cat_fil.filter_name filter_name 				, cat_fil.filter_value filter_value 				, null filter_value_code 			from  				catalogo_filter cat_fil 				join catalogo_b2e_varianti cat on cat_fil.modello = cat.modello_principale and cat_fil.variante = cat.variante 			where coalesce(cat.cod_sottocategoria_b2c, '') != '' and cat_fil.filter_code != 'newArrivals'  		group by cat.cod_marchio, cat.cod_sottocategoria_b2c, cat_fil.lingua, cat_fil.filter_code, cat_fil.filter_name, cat_fil.filter_value 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10dde6130>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "INSERT INTO _l_20240719162837_136_catalogo_filtri \\n\\t\\t\\tselect \\n\\t\\t\\t\\tcat.cod_marchio cod_marchio\\n\\t\\t\\t\\t, cat.cod_sottocategoria_b2c cod_sottocategoria_b2c\\n\\t\\t\\t\\t, cat_fil.lingua lingua\\n\\t\\t\\t\\t, cat_fil.filter_code filter_code\\n\\t\\t\\t\\t, cat_fil.filter_name filter_name\\n\\t\\t\\t\\t, cat_fil.filter_value filter_value\\n\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\tfrom \\n\\t\\t\\t\\tcatalogo_filter cat_fil\\n\\t\\t\\t\\tjoin catalogo_b2e_varianti cat on cat_fil.modello = cat.modello_principale and cat_fil.variante = cat.variante\\n\\t\\t\\twhere coalesce(cat.cod_sottocategoria_b2c, \'\') != \'\' and cat_fil.filter_code != \'newArrivals\' \\n\\t\\t\\tgroup by cat.cod_marchio, cat.cod_sottocategoria_b2c, cat_fil.lingua, cat_fil.filter_code, cat_fil.filter_name, cat_fil.filter_value"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6130>
INFO:root:Eliminazione catalogo_filtri
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10dde6f10> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 1ms, 0] DROP TABLE IF EXISTS catalogo_filtri 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10dde6f10>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6f10> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "DROP TABLE IF EXISTS catalogo_filtri"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6f10>
INFO:root:Rinominazione _l_20240719162837_136_catalogo_filtri
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10dde6f10> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 4ms, 0] ALTER TABLE _l_20240719162837_136_catalogo_filtri RENAME TO catalogo_filtri 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10dde6f10>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6f10> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "ALTER TABLE _l_20240719162837_136_catalogo_filtri RENAME TO catalogo_filtri"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6f10>
DEBUG:mmfg.connection.sqlite:[conn:catalogo] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:catalogo, 21ms, 0] insert into catalogo_filtri  			(cod_marchio, cod_sottocategoria_b2c, filter_code, filter_name, filter_value, filter_value_code, lingua) 			select  				filtri.cod_marchio 				, filtri.cod_sottocategoria_b2c 		, filtri.filter_code 				, filtri.filter_name 				, filtri.filter_value 				, filtri.filter_value_code 		, lang.lingua  			from  				( 					select a.* 						, nuovi_filtri.filter_code  						, nuovi_filtri.filter_name 						, case when nuovi_filtri.filter_value = 'PREZZO_V' then cb2e.prez_v 							else nuovi_filtri.filter_value end filter_value 						, nuovi_filtri.filter_value_code filter_value_code 					from 					( 						select  				cod_marchio 							, cod_sottocategoria_b2c  						from  						catalogo_b2e 						where cod_marchio in ('MC') 						group by cod_marchio, cod_sottocategoria_b2c 		) a  					join ( 						select  							'newArrivals' filter_code 	, 'Nuovi Arrivi' filter_name 							, 'SI' filter_value 							, null filter_value_code 	union all  						select  							'newArrivals' filter_code 					, 'Nuovi Arrivi' filter_name 							, 'NO' filter_value 							, null filter_value_code 	union all  							select  							'modelB2C' filter_code 					, 'Con Foto' filter_name 							, 'SI' filter_value 							, null filter_value_code 	union all  						select  							'modelB2C' filter_code 						, 'Con Foto' filter_name 							, 'NO' filter_value 							, null filter_value_code 	union all 						select  							'onSale' filter_code 						, 'In Saldo' filter_name 							, 'SI' filter_value 							, null filter_value_code 	union all 						select  							'onSale' filter_code 						, 'In Saldo' filter_name 							, 'NO' filter_value 							, null filter_value_code 	union all 						select  							'sizes' filter_code 						, 'Taglie' filter_name 							, '' filter_value 							, null filter_value_code 		union all 						select  							'stock' filter_code 						, 'In giacenza' filter_name 							, 'SI' filter_value 							, null filter_value_code 	union all 						select  							'stock' filter_code 						, 'In giacenza' filter_name 							, 'NO' filter_value 							, null filter_value_code 	union all 						select  							'price' filter_code 						, 'Prezzo' filter_name 							, '0' filter_value 							, null filter_value_code 		union all 						select  							'price' filter_code 						, 'Prezzo' filter_name 							, 'PREZZO_V' filter_value 							, null filter_value_code 	) nuovi_filtri on 1=1 					join ( 						select cod_marchio, cod_sottocategoria_b2c, max(prezzo_v) prez_v  		from catalogo_b2e  						join catalogo_b2e_prezzi on (catalogo_b2e.modello_principale = catalogo_b2e_prezzi.modello_principale)  		group by cod_marchio, cod_sottocategoria_b2c 						) cb2e on cb2e.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and cb2e.cod_marchio = a.cod_marchio 					union 					select a.* 						, coll.filter_value filter_value 		, coll.filter_value_code filter_value_code 					from 					( 						select  	cod_marchio 							, cod_sottocategoria_b2c  							, 'collection' filter_code 		, 'Collezione' filter_name 						from  							catalogo_b2e 						where cod_marchio in ('MC') 						group by cod_marchio, cod_sottocategoria_b2c 					) a  				join ( 						select cod_marchio, cod_sottocategoria_b2c,  desc_collezione filter_value, collezione filter_value_code from catalogo_b2e group by cod_marchio, cod_sottocategoria_b2c, collezione,  desc_collezione 					) coll on coll.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and coll.cod_marchio = a.cod_marchio 					union 					select a.* 						, coll.filter_value filter_value 	, coll.filter_value_code filter_value_code 					from 					( 						select  	cod_marchio 							, cod_sottocategoria_b2c  							, 'mainline' filter_code 		, 'Main Line' filter_name 						from  							catalogo_b2e 						where cod_marchio in ('MC') 						group by cod_marchio, cod_sottocategoria_b2c 					) a  				join ( 						select cod_marchio, cod_sottocategoria_b2c,  desc_main_line filter_value, main_line filter_value_code from catalogo_b2e group by cod_marchio, cod_sottocategoria_b2c, main_line, desc_main_line 					) coll on coll.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and coll.cod_marchio = a.cod_marchio 					union 					select a.* 						, annst.filter_value filter_value 		, annst.filter_value_code filter_value_code 					from 					( 						select  	cod_marchio 							, cod_sottocategoria_b2c  							, 'yearSeason' filter_code 		, 'Anno stagione' filter_name 						from  							catalogo_b2e 						where cod_marchio in ('MC') 						group by cod_marchio, cod_sottocategoria_b2c 					) a  				join ( 						select cod_marchio, cod_sottocategoria_b2c,  annostag filter_value, annostag filter_value_code from catalogo_b2e group by cod_marchio, cod_sottocategoria_b2c, annostag 					) annst on annst.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and annst.cod_marchio = a.cod_marchio 		) filtri 			join  				( 					select 'IT' lingua union all select 'EN' lingua union all select 'FR' lingua union all select 'ES' lingua union all select 'PT' lingua union all select 'DE' lingua union all select 'JA' lingua union all select 'ZH' lingua union all select 'NL' lingua union all select 'DK' lingua union all select 'HU' lingua union all select 'PL' lingua union all select 'EL' lingua union all select 'ZH_TW' lingua union all select 'SV' lingua union all select 'ES_CA' lingua 				) lang on 1=1 
INFO:mmfg.connection.sqlite:[conn:catalogo, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:catalogo] closed <config.db.PosWebDbConnection object at 0x10dde6130>
DEBUG:mmfg.connection.sqlite:[conn:sync] connected <config.db.PosWebDbConnection object at 0x10dde6130> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:sync, 1ms, 0] INSERT INTO sync_queue (dbname, key_name, key_value, data_modifica) VALUES (?,?,?,?) (params: ('catalogo', 'query', '{"sql": "insert into catalogo_filtri \\n\\t\\t\\t(cod_marchio, cod_sottocategoria_b2c, filter_code, filter_name, filter_value, filter_value_code, lingua)\\n\\t\\t\\tselect \\n\\t\\t\\t\\tfiltri.cod_marchio\\n\\t\\t\\t\\t, filtri.cod_sottocategoria_b2c\\n\\t\\t\\t\\t, filtri.filter_code\\n\\t\\t\\t\\t, filtri.filter_name\\n\\t\\t\\t\\t, filtri.filter_value\\n\\t\\t\\t\\t, filtri.filter_value_code\\n\\t\\t\\t\\t, lang.lingua \\n\\t\\t\\tfrom \\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\tselect a.*\\n\\t\\t\\t\\t\\t\\t, nuovi_filtri.filter_code \\n\\t\\t\\t\\t\\t\\t, nuovi_filtri.filter_name\\n\\t\\t\\t\\t\\t\\t, case when nuovi_filtri.filter_value = \'PREZZO_V\' then cb2e.prez_v\\n\\t\\t\\t\\t\\t\\t\\telse nuovi_filtri.filter_value end filter_value\\n\\t\\t\\t\\t\\t\\t, nuovi_filtri.filter_value_code filter_value_code\\n\\t\\t\\t\\t\\tfrom\\n\\t\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\tcod_marchio\\n\\t\\t\\t\\t\\t\\t\\t, cod_sottocategoria_b2c \\n\\t\\t\\t\\t\\t\\tfrom \\n\\t\\t\\t\\t\\t\\t\\tcatalogo_b2e\\n\\t\\t\\t\\t\\t\\twhere cod_marchio in (\'MC\')\\n\\t\\t\\t\\t\\t\\tgroup by cod_marchio, cod_sottocategoria_b2c\\n\\t\\t\\t\\t\\t) a \\n\\t\\t\\t\\t\\tjoin (\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'newArrivals\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Nuovi Arrivi\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'SI\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all \\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'newArrivals\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Nuovi Arrivi\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'NO\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all \\n\\t\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'modelB2C\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Con Foto\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'SI\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all \\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'modelB2C\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Con Foto\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'NO\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'onSale\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'In Saldo\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'SI\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'onSale\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'In Saldo\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'NO\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'sizes\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Taglie\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'stock\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'In giacenza\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'SI\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'stock\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'In giacenza\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'NO\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'price\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Prezzo\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'0\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t\\tunion all\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\t\'price\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Prezzo\' filter_name\\n\\t\\t\\t\\t\\t\\t\\t, \'PREZZO_V\' filter_value\\n\\t\\t\\t\\t\\t\\t\\t, null filter_value_code\\n\\t\\t\\t\\t\\t) nuovi_filtri on 1=1\\n\\t\\t\\t\\t\\tjoin (\\n\\t\\t\\t\\t\\t\\tselect cod_marchio, cod_sottocategoria_b2c, max(prezzo_v) prez_v \\n\\t\\t\\t\\t\\t\\tfrom catalogo_b2e \\n\\t\\t\\t\\t\\t\\tjoin catalogo_b2e_prezzi on (catalogo_b2e.modello_principale = catalogo_b2e_prezzi.modello_principale) \\n\\t\\t\\t\\t\\t\\tgroup by cod_marchio, cod_sottocategoria_b2c\\n\\t\\t\\t\\t\\t\\t) cb2e on cb2e.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and cb2e.cod_marchio = a.cod_marchio\\n\\t\\t\\t\\t\\tunion\\n\\t\\t\\t\\t\\tselect a.*\\n\\t\\t\\t\\t\\t\\t, coll.filter_value filter_value\\n\\t\\t\\t\\t\\t\\t, coll.filter_value_code filter_value_code\\n\\t\\t\\t\\t\\tfrom\\n\\t\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\tcod_marchio\\n\\t\\t\\t\\t\\t\\t\\t, cod_sottocategoria_b2c \\n\\t\\t\\t\\t\\t\\t\\t, \'collection\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Collezione\' filter_name\\n\\t\\t\\t\\t\\t\\tfrom \\n\\t\\t\\t\\t\\t\\t\\tcatalogo_b2e\\n\\t\\t\\t\\t\\t\\twhere cod_marchio in (\'MC\')\\n\\t\\t\\t\\t\\t\\tgroup by cod_marchio, cod_sottocategoria_b2c\\n\\t\\t\\t\\t\\t) a \\n\\t\\t\\t\\t\\tjoin (\\n\\t\\t\\t\\t\\t\\tselect cod_marchio, cod_sottocategoria_b2c,  desc_collezione filter_value, collezione filter_value_code from catalogo_b2e group by cod_marchio, cod_sottocategoria_b2c, collezione,  desc_collezione\\n\\t\\t\\t\\t\\t) coll on coll.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and coll.cod_marchio = a.cod_marchio\\n\\t\\t\\t\\t\\tunion\\n\\t\\t\\t\\t\\tselect a.*\\n\\t\\t\\t\\t\\t\\t, coll.filter_value filter_value\\n\\t\\t\\t\\t\\t\\t, coll.filter_value_code filter_value_code\\n\\t\\t\\t\\t\\tfrom\\n\\t\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\tcod_marchio\\n\\t\\t\\t\\t\\t\\t\\t, cod_sottocategoria_b2c \\n\\t\\t\\t\\t\\t\\t\\t, \'mainline\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Main Line\' filter_name\\n\\t\\t\\t\\t\\t\\tfrom \\n\\t\\t\\t\\t\\t\\t\\tcatalogo_b2e\\n\\t\\t\\t\\t\\t\\twhere cod_marchio in (\'MC\')\\n\\t\\t\\t\\t\\t\\tgroup by cod_marchio, cod_sottocategoria_b2c\\n\\t\\t\\t\\t\\t) a \\n\\t\\t\\t\\t\\tjoin (\\n\\t\\t\\t\\t\\t\\tselect cod_marchio, cod_sottocategoria_b2c,  desc_main_line filter_value, main_line filter_value_code from catalogo_b2e group by cod_marchio, cod_sottocategoria_b2c, main_line, desc_main_line\\n\\t\\t\\t\\t\\t) coll on coll.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and coll.cod_marchio = a.cod_marchio\\n\\t\\t\\t\\t\\tunion\\n\\t\\t\\t\\t\\tselect a.*\\n\\t\\t\\t\\t\\t\\t, annst.filter_value filter_value\\n\\t\\t\\t\\t\\t\\t, annst.filter_value_code filter_value_code\\n\\t\\t\\t\\t\\tfrom\\n\\t\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t\\tselect \\n\\t\\t\\t\\t\\t\\t\\tcod_marchio\\n\\t\\t\\t\\t\\t\\t\\t, cod_sottocategoria_b2c \\n\\t\\t\\t\\t\\t\\t\\t, \'yearSeason\' filter_code\\n\\t\\t\\t\\t\\t\\t\\t, \'Anno stagione\' filter_name\\n\\t\\t\\t\\t\\t\\tfrom \\n\\t\\t\\t\\t\\t\\t\\tcatalogo_b2e\\n\\t\\t\\t\\t\\t\\twhere cod_marchio in (\'MC\')\\n\\t\\t\\t\\t\\t\\tgroup by cod_marchio, cod_sottocategoria_b2c\\n\\t\\t\\t\\t\\t) a \\n\\t\\t\\t\\t\\tjoin (\\n\\t\\t\\t\\t\\t\\tselect cod_marchio, cod_sottocategoria_b2c,  annostag filter_value, annostag filter_value_code from catalogo_b2e group by cod_marchio, cod_sottocategoria_b2c, annostag\\n\\t\\t\\t\\t\\t) annst on annst.cod_sottocategoria_b2c = a.cod_sottocategoria_b2c and annst.cod_marchio = a.cod_marchio\\n\\t\\t\\t\\t) filtri\\n\\t\\t\\tjoin \\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\tselect \'IT\' lingua union all select \'EN\' lingua union all select \'FR\' lingua union all select \'ES\' lingua union all select \'PT\' lingua union all select \'DE\' lingua union all select \'JA\' lingua union all select \'ZH\' lingua union all select \'NL\' lingua union all select \'DK\' lingua union all select \'HU\' lingua union all select \'PL\' lingua union all select \'EL\' lingua union all select \'ZH_TW\' lingua union all select \'SV\' lingua union all select \'ES_CA\' lingua\\n\\t\\t\\t\\t) lang on 1=1"}', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:sync, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:sync] closed <config.db.PosWebDbConnection object at 0x10dde6130>
DEBUG:mmfg.connection.sqlite:[conn:local] connected <config.db.PosWebDbConnection object at 0x10debdca0> in 0ms, transactions=False
INFO:mmfg.connection.sqlite:[conn:local, 0ms] begin
INFO:mmfg.connection.sqlite:[conn:local, 1ms, 0] REPLACE INTO local_status (key_name, key_value, data_modifica) VALUES (?,?,?) (params: ('B2E_TABLES_CREATION', '2024-07-19 16:28:37', '2024-07-19 14:28:37'))
INFO:mmfg.connection.sqlite:[conn:local, 0ms] commit
DEBUG:mmfg.connection.sqlite:[conn:local] closed <config.db.PosWebDbConnection object at 0x10debdca0>
Exception ignored in: <function SQLiteConnection.__del__ at 0x10d131280>
Traceback (most recent call last):
  File "/rnd/pos/mmfg/posweb/site/bin/struttura/_2_4/connection/sqlite.py", line 109, in __del__
  File "/rnd/pos/mmfg/posweb/site/bin/struttura/_2_4/connection/sqlite.py", line 153, in close
AttributeError: 'NoneType' object has no attribute 'debug'
Exception ignored in: <function SQLiteConnection.__del__ at 0x10d131280>
Traceback (most recent call last):
  File "/rnd/pos/mmfg/posweb/site/bin/struttura/_2_4/connection/sqlite.py", line 109, in __del__
  File "/rnd/pos/mmfg/posweb/site/bin/struttura/_2_4/connection/sqlite.py", line 153, in close
AttributeError: 'NoneType' object has no attribute 'debug'
FGNEG-0100107-1:posweb posweb$ 


Catalogo B2E:
SELECT DISTINCT c.* , GROUP_CONCAT(DISTINCT c.variante), GROUP_CONCAT(DISTINCT c.raggruppamento_colore), GROUP_CONCAT(DISTINCT c.sku)
FROM catalogo c
INNER JOIN prezzi p ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "20200728"
WHERE c.sku_padre = "" AND c.validita_variante IN ("V", "B")
AND c.versione_modello = "V" AND c.data_consegna IS NOT NULL AND c.data_consegna <> "00000000" AND c.data_consegna <= '20200728' AND c.cod_marchio in ('MM') AND ((
c.cod_marchio_originale='WE' AND c.annostag='20202')OR(c.cod_marchio_originale='SP' AND c.annostag='20202')OR(c.cod_marchio_originale='MA' AND c.annostag='20201')OR(
c.cod_marchio_originale='MC' AND c.annostag='20201')OR(c.cod_marchio_originale='SP' AND c.annostag='20201')OR(c.cod_marchio_originale='MM' AND c.annostag='20201')OR(
c.cod_marchio_originale='MA' AND c.annostag='20202')OR(c.cod_marchio_originale='MR' AND c.annostag='20202')OR(c.cod_marchio_originale='MM' AND c.annostag='20202')OR(
c.cod_marchio_originale='MC' AND c.annostag='20202')OR(c.cod_marchio_originale='WE' AND c.annostag='20201')OR(c.cod_marchio_originale='MR' AND c.annostag='20201')) AND
p.cod_negozio in ('4401006')
GROUP BY c.modello_principale;

Prezzi:
SELECT DISTINCT c.modello_principale, p.cod_negozio , REPLACE(MAX(p.data_inizio_validita || "|" || p.prezzo), MAX(
p.data_inizio_validita || "|"), "")
FROM catalogo c INNER JOIN prezzi p ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "
20200728"
WHERE c.sku_padre = "" AND c.validita_variante IN ("V", "B") AND c.versione_modello = "V" AND c.data_consegna IS NOT NULL AND c.data_consegna <> "00000000" AND
c.data_consegna <= '20200728' AND c.cod_marchio in ('MM') AND ((c.cod_marchio_originale='WE' AND c.annostag='20202')OR(c.cod_marchio_originale='SP' AND c.annostag='20202')OR(
c.cod_marchio_originale='MA' AND c.annostag='20201')OR(c.cod_marchio_originale='MC' AND c.annostag='20201')OR(c.cod_marchio_originale='SP' AND c.annostag='20201')OR(
c.cod_marchio_originale='MM' AND c.annostag='20201')OR(c.cod_marchio_originale='MA' AND c.annostag='20202')OR(c.cod_marchio_originale='MR' AND c.annostag='20202')OR(
c.cod_marchio_originale='MM' AND c.annostag='20202')OR(c.cod_marchio_originale='MC' AND c.annostag='20202')OR(c.cod_marchio_originale='WE' AND c.annostag='20201')OR(
c.cod_marchio_originale='MR' AND c.annostag='20201')) AND p.cod_negozio in ('4401006');
GROUP BY c.modello_principale, p.cod_negozio

Catalogo B2E Varianti:
SELECT DISTINCT c.* , '[' || GROUP_CONCAT(DISTINCT('["' || c.sku || '","' || c.taglia || '","' || c.desc_taglia || '",' || IFNULL(c.indice_tg, 'null') || ']')) || ']'
FROM catalogo c
INNER JOIN prezzi p ON p.modello=c.modello AND p.pezzo=c.pezzo AND p.tipo_prezzo="V" AND p.data_inizio_validita <= "20200728"
WHERE c.sku_padre = "" AND
c.validita_variante IN ("V", "B") AND c.versione_modello = "V" AND c.data_consegna IS NOT NULL AND c.data_consegna <> "00000000" AND c.data_consegna <= '20200728' AND c.cod_marchio
in ('MM') AND ((c.cod_marchio_originale='WE' AND c.annostag='20202')OR(c.cod_marchio_originale='SP' AND c.annostag='20202')OR(c.cod_marchio_originale='MA' AND c.annostag='20201')
OR(c.cod_marchio_originale='MC' AND c.annostag='20201')OR(c.cod_marchio_originale='SP' AND c.annostag='20201')OR(c.cod_marchio_originale='MM' AND c.annostag='20201')OR(
c.cod_marchio_originale='MA' AND c.annostag='20202')OR(c.cod_marchio_originale='MR' AND c.annostag='20202')OR(c.cod_marchio_originale='MM' AND c.annostag='20202')OR(
c.cod_marchio_originale='MC' AND c.annostag='20202')OR(c.cod_marchio_originale='WE' AND c.annostag='20201')OR(c.cod_marchio_originale='MR' AND c.annostag='20201')) AND
p.cod_negozio in ('4401006')GROUP BY c.modello_principale, c.variante;


UN TEST DI CHIAMATA IN LINGUA PRIMA VADO SU BMS E SETTO IL MIO UTENTE 
NELLA LINGUA DESIDERATA (ES, CINESE) POI ACCEDO AL POSLITE CON IL MIO UTENTE
E IL SID SARA' IMPOSTATO CON QUELLA LINGUA, COSì CHE ANCHE I SERVIZI DOVREBBERO
ESSERE PIU' ATTENDIBILI NELLA RISPOSTA IN LINGUA PER /MODELS OPPURE /CATEGORIES